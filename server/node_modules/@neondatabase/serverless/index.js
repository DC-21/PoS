"use strict";var va=Object.create;var De=Object.defineProperty;var Ea=Object.getOwnPropertyDescriptor;var _a=Object.getOwnPropertyNames;var Ua=Object.getPrototypeOf,Ca=Object.prototype.hasOwnProperty;var Ia=(r,e,t)=>e in r?De(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var o=(r,e)=>De(r,"name",{value:e,configurable:!0});var ne=(r,e)=>()=>(r&&(e=r(r=0)),e);var T=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),we=(r,e)=>{for(var t in e)De(r,t,{get:e[t],enumerable:!0})},Ln=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of _a(e))!Ca.call(r,i)&&i!==t&&De(r,i,{get:()=>e[i],enumerable:!(n=Ea(e,i))||n.enumerable});return r};var nt=(r,e,t)=>(t=r!=null?va(Ua(r)):{},Ln(e||!r||!r.__esModule?De(t,"default",{value:r,enumerable:!0}):t,r)),Y=r=>Ln(De({},"__esModule",{value:!0}),r);var g=(r,e,t)=>(Ia(r,typeof e!="symbol"?e+"":e,t),t);var Pn=T(Ut=>{"use strict";p();Ut.byteLength=Ta;Ut.toByteArray=Pa;Ut.fromByteArray=Ma;var Ae=[],me=[],La=typeof Uint8Array<"u"?Uint8Array:Array,Ar="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Re=0,Tn=Ar.length;Re<Tn;++Re)Ae[Re]=Ar[Re],me[Ar.charCodeAt(Re)]=Re;var Re,Tn;me["-".charCodeAt(0)]=62;me["_".charCodeAt(0)]=63;function Bn(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}o(Bn,"getLens");function Ta(r){var e=Bn(r),t=e[0],n=e[1];return(t+n)*3/4-n}o(Ta,"byteLength");function Ba(r,e,t){return(e+t)*3/4-t}o(Ba,"_byteLength");function Pa(r){var e,t=Bn(r),n=t[0],i=t[1],s=new La(Ba(r,n,i)),a=0,u=i>0?n-4:n,c;for(c=0;c<u;c+=4)e=me[r.charCodeAt(c)]<<18|me[r.charCodeAt(c+1)]<<12|me[r.charCodeAt(c+2)]<<6|me[r.charCodeAt(c+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return i===2&&(e=me[r.charCodeAt(c)]<<2|me[r.charCodeAt(c+1)]>>4,s[a++]=e&255),i===1&&(e=me[r.charCodeAt(c)]<<10|me[r.charCodeAt(c+1)]<<4|me[r.charCodeAt(c+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}o(Pa,"toByteArray");function Ra(r){return Ae[r>>18&63]+Ae[r>>12&63]+Ae[r>>6&63]+Ae[r&63]}o(Ra,"tripletToBase64");function Fa(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),i.push(Ra(n));return i.join("")}o(Fa,"encodeChunk");function Ma(r){for(var e,t=r.length,n=t%3,i=[],s=16383,a=0,u=t-n;a<u;a+=s)i.push(Fa(r,a,a+s>u?u:a+s));return n===1?(e=r[t-1],i.push(Ae[e>>2]+Ae[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(Ae[e>>10]+Ae[e>>4&63]+Ae[e<<2&63]+"=")),i.join("")}o(Ma,"fromByteArray")});var Rn=T(vr=>{p();vr.read=function(r,e,t,n,i){var s,a,u=i*8-n-1,c=(1<<u)-1,h=c>>1,l=-7,f=t?i-1:0,m=t?-1:1,b=r[e+f];for(f+=m,s=b&(1<<-l)-1,b>>=-l,l+=u;l>0;s=s*256+r[e+f],f+=m,l-=8);for(a=s&(1<<-l)-1,s>>=-l,l+=n;l>0;a=a*256+r[e+f],f+=m,l-=8);if(s===0)s=1-h;else{if(s===c)return a?NaN:(b?-1:1)*(1/0);a=a+Math.pow(2,n),s=s-h}return(b?-1:1)*a*Math.pow(2,s-n)};vr.write=function(r,e,t,n,i,s){var a,u,c,h=s*8-i-1,l=(1<<h)-1,f=l>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=n?0:s-1,_=n?1:-1,L=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+f>=1?e+=m/c:e+=m*Math.pow(2,1-f),e*c>=2&&(a++,c/=2),a+f>=l?(u=0,a=l):a+f>=1?(u=(e*c-1)*Math.pow(2,i),a=a+f):(u=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;r[t+b]=u&255,b+=_,u/=256,i-=8);for(a=a<<i|u,h+=i;h>0;r[t+b]=a&255,b+=_,a/=256,h-=8);r[t+b-_]|=L*128}});var Yn=T(He=>{"use strict";p();var Er=Pn(),Oe=Rn(),Fn=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;He.Buffer=d;He.SlowBuffer=Qa;He.INSPECT_MAX_BYTES=50;var Ct=2147483647;He.kMaxLength=Ct;d.TYPED_ARRAY_SUPPORT=ka();!d.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function ka(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}o(ka,"typedArraySupport");Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(!!d.isBuffer(this))return this.buffer}});Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(!!d.isBuffer(this))return this.byteOffset}});function Ue(r){if(r>Ct)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,d.prototype),e}o(Ue,"createBuffer");function d(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Ir(r)}return Dn(r,e,t)}o(d,"Buffer");d.poolSize=8192;function Dn(r,e,t){if(typeof r=="string")return Da(r,e);if(ArrayBuffer.isView(r))return qa(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(ve(r,ArrayBuffer)||r&&ve(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ve(r,SharedArrayBuffer)||r&&ve(r.buffer,SharedArrayBuffer)))return Ur(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=r.valueOf&&r.valueOf();if(n!=null&&n!==r)return d.from(n,e,t);let i=Oa(r);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return d.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}o(Dn,"from");d.from=function(r,e,t){return Dn(r,e,t)};Object.setPrototypeOf(d.prototype,Uint8Array.prototype);Object.setPrototypeOf(d,Uint8Array);function qn(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}o(qn,"assertSize");function Na(r,e,t){return qn(r),r<=0?Ue(r):e!==void 0?typeof t=="string"?Ue(r).fill(e,t):Ue(r).fill(e):Ue(r)}o(Na,"alloc");d.alloc=function(r,e,t){return Na(r,e,t)};function Ir(r){return qn(r),Ue(r<0?0:Lr(r)|0)}o(Ir,"allocUnsafe");d.allocUnsafe=function(r){return Ir(r)};d.allocUnsafeSlow=function(r){return Ir(r)};function Da(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!d.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=On(r,e)|0,n=Ue(t),i=n.write(r,e);return i!==t&&(n=n.slice(0,i)),n}o(Da,"fromString");function _r(r){let e=r.length<0?0:Lr(r.length)|0,t=Ue(e);for(let n=0;n<e;n+=1)t[n]=r[n]&255;return t}o(_r,"fromArrayLike");function qa(r){if(ve(r,Uint8Array)){let e=new Uint8Array(r);return Ur(e.buffer,e.byteOffset,e.byteLength)}return _r(r)}o(qa,"fromArrayView");function Ur(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&t===void 0?n=new Uint8Array(r):t===void 0?n=new Uint8Array(r,e):n=new Uint8Array(r,e,t),Object.setPrototypeOf(n,d.prototype),n}o(Ur,"fromArrayBuffer");function Oa(r){if(d.isBuffer(r)){let e=Lr(r.length)|0,t=Ue(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||Br(r.length)?Ue(0):_r(r);if(r.type==="Buffer"&&Array.isArray(r.data))return _r(r.data)}o(Oa,"fromObject");function Lr(r){if(r>=Ct)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ct.toString(16)+" bytes");return r|0}o(Lr,"checked");function Qa(r){return+r!=r&&(r=0),d.alloc(+r)}o(Qa,"SlowBuffer");d.isBuffer=o(function(e){return e!=null&&e._isBuffer===!0&&e!==d.prototype},"isBuffer");d.compare=o(function(e,t){if(ve(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),ve(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,i=t.length;for(let s=0,a=Math.min(n,i);s<a;++s)if(e[s]!==t[s]){n=e[s],i=t[s];break}return n<i?-1:i<n?1:0},"compare");d.isEncoding=o(function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding");d.concat=o(function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return d.alloc(0);let n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;let i=d.allocUnsafe(t),s=0;for(n=0;n<e.length;++n){let a=e[n];if(ve(a,Uint8Array))s+a.length>i.length?(d.isBuffer(a)||(a=d.from(a)),a.copy(i,s)):Uint8Array.prototype.set.call(i,a,s);else if(d.isBuffer(a))a.copy(i,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=a.length}return i},"concat");function On(r,e){if(d.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||ve(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&t===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Cr(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return zn(r).length;default:if(i)return n?-1:Cr(r).length;e=(""+e).toLowerCase(),i=!0}}o(On,"byteLength");d.byteLength=On;function Ha(r,e,t){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return Za(this,e,t);case"utf8":case"utf-8":return Hn(this,e,t);case"ascii":return Ya(this,e,t);case"latin1":case"binary":return Ja(this,e,t);case"base64":return Ga(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Xa(this,e,t);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}o(Ha,"slowToString");d.prototype._isBuffer=!0;function Fe(r,e,t){let n=r[e];r[e]=r[t],r[t]=n}o(Fe,"swap");d.prototype.swap16=o(function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)Fe(this,t,t+1);return this},"swap16");d.prototype.swap32=o(function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)Fe(this,t,t+3),Fe(this,t+1,t+2);return this},"swap32");d.prototype.swap64=o(function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)Fe(this,t,t+7),Fe(this,t+1,t+6),Fe(this,t+2,t+5),Fe(this,t+3,t+4);return this},"swap64");d.prototype.toString=o(function(){let e=this.length;return e===0?"":arguments.length===0?Hn(this,0,e):Ha.apply(this,arguments)},"toString");d.prototype.toLocaleString=d.prototype.toString;d.prototype.equals=o(function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:d.compare(this,e)===0},"equals");d.prototype.inspect=o(function(){let e="",t=He.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},"inspect");Fn&&(d.prototype[Fn]=d.prototype.inspect);d.prototype.compare=o(function(e,t,n,i,s){if(ve(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),s===void 0&&(s=this.length),t<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&t>=n)return 0;if(i>=s)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;let a=s-i,u=n-t,c=Math.min(a,u),h=this.slice(i,s),l=e.slice(t,n);for(let f=0;f<c;++f)if(h[f]!==l[f]){a=h[f],u=l[f];break}return a<u?-1:u<a?1:0},"compare");function Qn(r,e,t,n,i){if(r.length===0)return-1;if(typeof t=="string"?(n=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,Br(t)&&(t=i?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(i)return-1;t=r.length-1}else if(t<0)if(i)t=0;else return-1;if(typeof e=="string"&&(e=d.from(e,n)),d.isBuffer(e))return e.length===0?-1:Mn(r,e,t,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Mn(r,[e],t,n,i);throw new TypeError("val must be string, number or Buffer")}o(Qn,"bidirectionalIndexOf");function Mn(r,e,t,n,i){let s=1,a=r.length,u=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,a/=2,u/=2,t/=2}function c(l,f){return s===1?l[f]:l.readUInt16BE(f*s)}o(c,"read");let h;if(i){let l=-1;for(h=t;h<a;h++)if(c(r,h)===c(e,l===-1?0:h-l)){if(l===-1&&(l=h),h-l+1===u)return l*s}else l!==-1&&(h-=h-l),l=-1}else for(t+u>a&&(t=a-u),h=t;h>=0;h--){let l=!0;for(let f=0;f<u;f++)if(c(r,h+f)!==c(e,f)){l=!1;break}if(l)return h}return-1}o(Mn,"arrayIndexOf");d.prototype.includes=o(function(e,t,n){return this.indexOf(e,t,n)!==-1},"includes");d.prototype.indexOf=o(function(e,t,n){return Qn(this,e,t,n,!0)},"indexOf");d.prototype.lastIndexOf=o(function(e,t,n){return Qn(this,e,t,n,!1)},"lastIndexOf");function ja(r,e,t,n){t=Number(t)||0;let i=r.length-t;n?(n=Number(n),n>i&&(n=i)):n=i;let s=e.length;n>s/2&&(n=s/2);let a;for(a=0;a<n;++a){let u=parseInt(e.substr(a*2,2),16);if(Br(u))return a;r[t+a]=u}return a}o(ja,"hexWrite");function Ka(r,e,t,n){return It(Cr(e,r.length-t),r,t,n)}o(Ka,"utf8Write");function $a(r,e,t,n){return It(no(e),r,t,n)}o($a,"asciiWrite");function Wa(r,e,t,n){return It(zn(e),r,t,n)}o(Wa,"base64Write");function Va(r,e,t,n){return It(io(e,r.length-t),r,t,n)}o(Va,"ucs2Write");d.prototype.write=o(function(e,t,n,i){if(t===void 0)i="utf8",n=this.length,t=0;else if(n===void 0&&typeof t=="string")i=t,n=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-t;if((n===void 0||n>s)&&(n=s),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let a=!1;for(;;)switch(i){case"hex":return ja(this,e,t,n);case"utf8":case"utf-8":return Ka(this,e,t,n);case"ascii":case"latin1":case"binary":return $a(this,e,t,n);case"base64":return Wa(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Va(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},"write");d.prototype.toJSON=o(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function Ga(r,e,t){return e===0&&t===r.length?Er.fromByteArray(r):Er.fromByteArray(r.slice(e,t))}o(Ga,"base64Slice");function Hn(r,e,t){t=Math.min(r.length,t);let n=[],i=e;for(;i<t;){let s=r[i],a=null,u=s>239?4:s>223?3:s>191?2:1;if(i+u<=t){let c,h,l,f;switch(u){case 1:s<128&&(a=s);break;case 2:c=r[i+1],(c&192)===128&&(f=(s&31)<<6|c&63,f>127&&(a=f));break;case 3:c=r[i+1],h=r[i+2],(c&192)===128&&(h&192)===128&&(f=(s&15)<<12|(c&63)<<6|h&63,f>2047&&(f<55296||f>57343)&&(a=f));break;case 4:c=r[i+1],h=r[i+2],l=r[i+3],(c&192)===128&&(h&192)===128&&(l&192)===128&&(f=(s&15)<<18|(c&63)<<12|(h&63)<<6|l&63,f>65535&&f<1114112&&(a=f))}}a===null?(a=65533,u=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|a&1023),n.push(a),i+=u}return za(n)}o(Hn,"utf8Slice");var kn=4096;function za(r){let e=r.length;if(e<=kn)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=kn));return t}o(za,"decodeCodePointsArray");function Ya(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]&127);return n}o(Ya,"asciiSlice");function Ja(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]);return n}o(Ja,"latin1Slice");function Za(r,e,t){let n=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>n)&&(t=n);let i="";for(let s=e;s<t;++s)i+=so[r[s]];return i}o(Za,"hexSlice");function Xa(r,e,t){let n=r.slice(e,t),i="";for(let s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+n[s+1]*256);return i}o(Xa,"utf16leSlice");d.prototype.slice=o(function(e,t){let n=this.length;e=~~e,t=t===void 0?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);let i=this.subarray(e,t);return Object.setPrototypeOf(i,d.prototype),i},"slice");function Z(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}o(Z,"checkOffset");d.prototype.readUintLE=d.prototype.readUIntLE=o(function(e,t,n){e=e>>>0,t=t>>>0,n||Z(e,t,this.length);let i=this[e],s=1,a=0;for(;++a<t&&(s*=256);)i+=this[e+a]*s;return i},"readUIntLE");d.prototype.readUintBE=d.prototype.readUIntBE=o(function(e,t,n){e=e>>>0,t=t>>>0,n||Z(e,t,this.length);let i=this[e+--t],s=1;for(;t>0&&(s*=256);)i+=this[e+--t]*s;return i},"readUIntBE");d.prototype.readUint8=d.prototype.readUInt8=o(function(e,t){return e=e>>>0,t||Z(e,1,this.length),this[e]},"readUInt8");d.prototype.readUint16LE=d.prototype.readUInt16LE=o(function(e,t){return e=e>>>0,t||Z(e,2,this.length),this[e]|this[e+1]<<8},"readUInt16LE");d.prototype.readUint16BE=d.prototype.readUInt16BE=o(function(e,t){return e=e>>>0,t||Z(e,2,this.length),this[e]<<8|this[e+1]},"readUInt16BE");d.prototype.readUint32LE=d.prototype.readUInt32LE=o(function(e,t){return e=e>>>0,t||Z(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},"readUInt32LE");d.prototype.readUint32BE=d.prototype.readUInt32BE=o(function(e,t){return e=e>>>0,t||Z(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},"readUInt32BE");d.prototype.readBigUInt64LE=Ie(o(function(e){e=e>>>0,Qe(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&it(e,this.length-8);let i=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(s)<<BigInt(32))},"readBigUInt64LE"));d.prototype.readBigUInt64BE=Ie(o(function(e){e=e>>>0,Qe(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&it(e,this.length-8);let i=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(s)},"readBigUInt64BE"));d.prototype.readIntLE=o(function(e,t,n){e=e>>>0,t=t>>>0,n||Z(e,t,this.length);let i=this[e],s=1,a=0;for(;++a<t&&(s*=256);)i+=this[e+a]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i},"readIntLE");d.prototype.readIntBE=o(function(e,t,n){e=e>>>0,t=t>>>0,n||Z(e,t,this.length);let i=t,s=1,a=this[e+--i];for(;i>0&&(s*=256);)a+=this[e+--i]*s;return s*=128,a>=s&&(a-=Math.pow(2,8*t)),a},"readIntBE");d.prototype.readInt8=o(function(e,t){return e=e>>>0,t||Z(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},"readInt8");d.prototype.readInt16LE=o(function(e,t){e=e>>>0,t||Z(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n},"readInt16LE");d.prototype.readInt16BE=o(function(e,t){e=e>>>0,t||Z(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n},"readInt16BE");d.prototype.readInt32LE=o(function(e,t){return e=e>>>0,t||Z(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},"readInt32LE");d.prototype.readInt32BE=o(function(e,t){return e=e>>>0,t||Z(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},"readInt32BE");d.prototype.readBigInt64LE=Ie(o(function(e){e=e>>>0,Qe(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&it(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)},"readBigInt64LE"));d.prototype.readBigInt64BE=Ie(o(function(e){e=e>>>0,Qe(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&it(e,this.length-8);let i=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)},"readBigInt64BE"));d.prototype.readFloatLE=o(function(e,t){return e=e>>>0,t||Z(e,4,this.length),Oe.read(this,e,!0,23,4)},"readFloatLE");d.prototype.readFloatBE=o(function(e,t){return e=e>>>0,t||Z(e,4,this.length),Oe.read(this,e,!1,23,4)},"readFloatBE");d.prototype.readDoubleLE=o(function(e,t){return e=e>>>0,t||Z(e,8,this.length),Oe.read(this,e,!0,52,8)},"readDoubleLE");d.prototype.readDoubleBE=o(function(e,t){return e=e>>>0,t||Z(e,8,this.length),Oe.read(this,e,!1,52,8)},"readDoubleBE");function he(r,e,t,n,i,s){if(!d.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(t+n>r.length)throw new RangeError("Index out of range")}o(he,"checkInt");d.prototype.writeUintLE=d.prototype.writeUIntLE=o(function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let u=Math.pow(2,8*n)-1;he(this,e,t,n,u,0)}let s=1,a=0;for(this[t]=e&255;++a<n&&(s*=256);)this[t+a]=e/s&255;return t+n},"writeUIntLE");d.prototype.writeUintBE=d.prototype.writeUIntBE=o(function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let u=Math.pow(2,8*n)-1;he(this,e,t,n,u,0)}let s=n-1,a=1;for(this[t+s]=e&255;--s>=0&&(a*=256);)this[t+s]=e/a&255;return t+n},"writeUIntBE");d.prototype.writeUint8=d.prototype.writeUInt8=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,1,255,0),this[t]=e&255,t+1},"writeUInt8");d.prototype.writeUint16LE=d.prototype.writeUInt16LE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},"writeUInt16LE");d.prototype.writeUint16BE=d.prototype.writeUInt16BE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},"writeUInt16BE");d.prototype.writeUint32LE=d.prototype.writeUInt32LE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},"writeUInt32LE");d.prototype.writeUint32BE=d.prototype.writeUInt32BE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},"writeUInt32BE");function jn(r,e,t,n,i){Gn(e,n,i,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let a=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=a,a=a>>8,r[t++]=a,a=a>>8,r[t++]=a,a=a>>8,r[t++]=a,t}o(jn,"wrtBigUInt64LE");function Kn(r,e,t,n,i){Gn(e,n,i,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let a=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=a,a=a>>8,r[t+2]=a,a=a>>8,r[t+1]=a,a=a>>8,r[t]=a,t+8}o(Kn,"wrtBigUInt64BE");d.prototype.writeBigUInt64LE=Ie(o(function(e,t=0){return jn(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE"));d.prototype.writeBigUInt64BE=Ie(o(function(e,t=0){return Kn(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE"));d.prototype.writeIntLE=o(function(e,t,n,i){if(e=+e,t=t>>>0,!i){let c=Math.pow(2,8*n-1);he(this,e,t,n,c-1,-c)}let s=0,a=1,u=0;for(this[t]=e&255;++s<n&&(a*=256);)e<0&&u===0&&this[t+s-1]!==0&&(u=1),this[t+s]=(e/a>>0)-u&255;return t+n},"writeIntLE");d.prototype.writeIntBE=o(function(e,t,n,i){if(e=+e,t=t>>>0,!i){let c=Math.pow(2,8*n-1);he(this,e,t,n,c-1,-c)}let s=n-1,a=1,u=0;for(this[t+s]=e&255;--s>=0&&(a*=256);)e<0&&u===0&&this[t+s+1]!==0&&(u=1),this[t+s]=(e/a>>0)-u&255;return t+n},"writeIntBE");d.prototype.writeInt8=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},"writeInt8");d.prototype.writeInt16LE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},"writeInt16LE");d.prototype.writeInt16BE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},"writeInt16BE");d.prototype.writeInt32LE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},"writeInt32LE");d.prototype.writeInt32BE=o(function(e,t,n){return e=+e,t=t>>>0,n||he(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},"writeInt32BE");d.prototype.writeBigInt64LE=Ie(o(function(e,t=0){return jn(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE"));d.prototype.writeBigInt64BE=Ie(o(function(e,t=0){return Kn(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function $n(r,e,t,n,i,s){if(t+n>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}o($n,"checkIEEE754");function Wn(r,e,t,n,i){return e=+e,t=t>>>0,i||$n(r,e,t,4,34028234663852886e22,-34028234663852886e22),Oe.write(r,e,t,n,23,4),t+4}o(Wn,"writeFloat");d.prototype.writeFloatLE=o(function(e,t,n){return Wn(this,e,t,!0,n)},"writeFloatLE");d.prototype.writeFloatBE=o(function(e,t,n){return Wn(this,e,t,!1,n)},"writeFloatBE");function Vn(r,e,t,n,i){return e=+e,t=t>>>0,i||$n(r,e,t,8,17976931348623157e292,-17976931348623157e292),Oe.write(r,e,t,n,52,8),t+8}o(Vn,"writeDouble");d.prototype.writeDoubleLE=o(function(e,t,n){return Vn(this,e,t,!0,n)},"writeDoubleLE");d.prototype.writeDoubleBE=o(function(e,t,n){return Vn(this,e,t,!1,n)},"writeDoubleBE");d.prototype.copy=o(function(e,t,n,i){if(!d.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);let s=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),s},"copy");d.prototype.fill=o(function(e,t,n,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!d.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let a=e.charCodeAt(0);(i==="utf8"&&a<128||i==="latin1")&&(e=a)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t=t>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<n;++s)this[s]=e;else{let a=d.isBuffer(e)?e:d.from(e,i),u=a.length;if(u===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=a[s%u]}return this},"fill");var qe={};function Tr(r,e,t){qe[r]=o(class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}},"NodeError")}o(Tr,"E");Tr("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Tr("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);Tr("ERR_OUT_OF_RANGE",function(r,e,t){let n=`The value of "${r}" is out of range.`,i=t;return Number.isInteger(t)&&Math.abs(t)>2**32?i=Nn(String(t)):typeof t=="bigint"&&(i=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(i=Nn(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function Nn(r){let e="",t=r.length,n=r[0]==="-"?1:0;for(;t>=n+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}o(Nn,"addNumericalSeparator");function eo(r,e,t){Qe(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&it(e,r.length-(t+1))}o(eo,"checkBounds");function Gn(r,e,t,n,i,s){if(r>t||r<e){let a=typeof e=="bigint"?"n":"",u;throw s>3?e===0||e===BigInt(0)?u=`>= 0${a} and < 2${a} ** ${(s+1)*8}${a}`:u=`>= -(2${a} ** ${(s+1)*8-1}${a}) and < 2 ** ${(s+1)*8-1}${a}`:u=`>= ${e}${a} and <= ${t}${a}`,new qe.ERR_OUT_OF_RANGE("value",u,r)}eo(n,i,s)}o(Gn,"checkIntBI");function Qe(r,e){if(typeof r!="number")throw new qe.ERR_INVALID_ARG_TYPE(e,"number",r)}o(Qe,"validateNumber");function it(r,e,t){throw Math.floor(r)!==r?(Qe(r,t),new qe.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new qe.ERR_BUFFER_OUT_OF_BOUNDS:new qe.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}o(it,"boundsError");var to=/[^+/0-9A-Za-z-_]/g;function ro(r){if(r=r.split("=")[0],r=r.trim().replace(to,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}o(ro,"base64clean");function Cr(r,e){e=e||1/0;let t,n=r.length,i=null,s=[];for(let a=0;a<n;++a){if(t=r.charCodeAt(a),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(a+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}o(Cr,"utf8ToBytes");function no(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}o(no,"asciiToBytes");function io(r,e){let t,n,i,s=[];for(let a=0;a<r.length&&!((e-=2)<0);++a)t=r.charCodeAt(a),n=t>>8,i=t%256,s.push(i),s.push(n);return s}o(io,"utf16leToBytes");function zn(r){return Er.toByteArray(ro(r))}o(zn,"base64ToBytes");function It(r,e,t,n){let i;for(i=0;i<n&&!(i+t>=e.length||i>=r.length);++i)e[i+t]=r[i];return i}o(It,"blitBuffer");function ve(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}o(ve,"isInstance");function Br(r){return r!==r}o(Br,"numberIsNaN");var so=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let n=t*16;for(let i=0;i<16;++i)e[n+i]=r[t]+r[i]}return e}();function Ie(r){return typeof BigInt>"u"?ao:r}o(Ie,"defineBigIntMethod");function ao(){throw new Error("BigInt not supported")}o(ao,"BufferBigIntNotDefined")});var v,E,U,S,y,w,p=ne(()=>{"use strict";v=globalThis,E=globalThis.setImmediate??(r=>setTimeout(r,0)),U=globalThis.clearImmediate??(r=>clearTimeout(r)),S=globalThis.crypto??{};S.subtle??(S.subtle={});y=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:Yn().Buffer,w=globalThis.process??{};w.env??(w.env={});try{w.nextTick(()=>{})}catch{let e=Promise.resolve();w.nextTick=e.then.bind(e)}});function st(r){let e=1779033703,t=3144134277,n=1013904242,i=2773480762,s=1359893119,a=2600822924,u=528734635,c=1541459225,h=0,l=0,f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],m=o((I,x)=>I>>>x|I<<32-x,"rrot"),b=new Uint32Array(64),_=new Uint8Array(64),L=o(()=>{for(let B=0,F=0;B<16;B++,F+=4)b[B]=_[F]<<24|_[F+1]<<16|_[F+2]<<8|_[F+3];for(let B=16;B<64;B++){let F=m(b[B-15],7)^m(b[B-15],18)^b[B-15]>>>3,q=m(b[B-2],17)^m(b[B-2],19)^b[B-2]>>>10;b[B]=b[B-16]+F+b[B-7]+q|0}let I=e,x=t,D=n,W=i,k=s,J=a,N=u,ye=c;for(let B=0;B<64;B++){let F=m(k,6)^m(k,11)^m(k,25),q=k&J^~k&N,j=ye+F+q+f[B]+b[B]|0,V=m(I,2)^m(I,13)^m(I,22),G=I&x^I&D^x&D,O=V+G|0;ye=N,N=J,J=k,k=W+j|0,W=D,D=x,x=I,I=j+O|0}e=e+I|0,t=t+x|0,n=n+D|0,i=i+W|0,s=s+k|0,a=a+J|0,u=u+N|0,c=c+ye|0,l=0},"process"),A=o(I=>{typeof I=="string"&&(I=new TextEncoder().encode(I));for(let x=0;x<I.length;x++)_[l++]=I[x],l===64&&L();h+=I.length},"add"),P=o(()=>{if(_[l++]=128,l==64&&L(),l+8>64){for(;l<64;)_[l++]=0;L()}for(;l<58;)_[l++]=0;let I=h*8;_[l++]=I/1099511627776&255,_[l++]=I/4294967296&255,_[l++]=I>>>24,_[l++]=I>>>16&255,_[l++]=I>>>8&255,_[l++]=I&255,L();let x=new Uint8Array(32);return x[0]=e>>>24,x[1]=e>>>16&255,x[2]=e>>>8&255,x[3]=e&255,x[4]=t>>>24,x[5]=t>>>16&255,x[6]=t>>>8&255,x[7]=t&255,x[8]=n>>>24,x[9]=n>>>16&255,x[10]=n>>>8&255,x[11]=n&255,x[12]=i>>>24,x[13]=i>>>16&255,x[14]=i>>>8&255,x[15]=i&255,x[16]=s>>>24,x[17]=s>>>16&255,x[18]=s>>>8&255,x[19]=s&255,x[20]=a>>>24,x[21]=a>>>16&255,x[22]=a>>>8&255,x[23]=a&255,x[24]=u>>>24,x[25]=u>>>16&255,x[26]=u>>>8&255,x[27]=u&255,x[28]=c>>>24,x[29]=c>>>16&255,x[30]=c>>>8&255,x[31]=c&255,x},"digest");return r===void 0?{add:A,digest:P}:(A(r),P())}var Zn=ne(()=>{"use strict";p();o(st,"sha256")});var le,xe,Xn=ne(()=>{"use strict";p();le=class{constructor(){g(this,"_dataLength",0);g(this,"_bufferLength",0);g(this,"_state",new Int32Array(4));g(this,"_buffer",new ArrayBuffer(68));g(this,"_buffer8");g(this,"_buffer32");this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(e,t=!1){return this.onePassHasher.start().appendByteArray(e).end(t)}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){let t=le.hexChars,n=le.hexOut,i,s,a,u;for(u=0;u<4;u+=1)for(s=u*8,i=e[u],a=0;a<8;a+=2)n[s+1+a]=t.charAt(i&15),i>>>=4,n[s+0+a]=t.charAt(i&15),i>>>=4;return n.join("")}static _md5cycle(e,t){let n=e[0],i=e[1],s=e[2],a=e[3];n+=(i&s|~i&a)+t[0]-680876936|0,n=(n<<7|n>>>25)+i|0,a+=(n&i|~n&s)+t[1]-389564586|0,a=(a<<12|a>>>20)+n|0,s+=(a&n|~a&i)+t[2]+606105819|0,s=(s<<17|s>>>15)+a|0,i+=(s&a|~s&n)+t[3]-1044525330|0,i=(i<<22|i>>>10)+s|0,n+=(i&s|~i&a)+t[4]-176418897|0,n=(n<<7|n>>>25)+i|0,a+=(n&i|~n&s)+t[5]+1200080426|0,a=(a<<12|a>>>20)+n|0,s+=(a&n|~a&i)+t[6]-1473231341|0,s=(s<<17|s>>>15)+a|0,i+=(s&a|~s&n)+t[7]-45705983|0,i=(i<<22|i>>>10)+s|0,n+=(i&s|~i&a)+t[8]+1770035416|0,n=(n<<7|n>>>25)+i|0,a+=(n&i|~n&s)+t[9]-1958414417|0,a=(a<<12|a>>>20)+n|0,s+=(a&n|~a&i)+t[10]-42063|0,s=(s<<17|s>>>15)+a|0,i+=(s&a|~s&n)+t[11]-1990404162|0,i=(i<<22|i>>>10)+s|0,n+=(i&s|~i&a)+t[12]+1804603682|0,n=(n<<7|n>>>25)+i|0,a+=(n&i|~n&s)+t[13]-40341101|0,a=(a<<12|a>>>20)+n|0,s+=(a&n|~a&i)+t[14]-1502002290|0,s=(s<<17|s>>>15)+a|0,i+=(s&a|~s&n)+t[15]+1236535329|0,i=(i<<22|i>>>10)+s|0,n+=(i&a|s&~a)+t[1]-165796510|0,n=(n<<5|n>>>27)+i|0,a+=(n&s|i&~s)+t[6]-1069501632|0,a=(a<<9|a>>>23)+n|0,s+=(a&i|n&~i)+t[11]+643717713|0,s=(s<<14|s>>>18)+a|0,i+=(s&n|a&~n)+t[0]-373897302|0,i=(i<<20|i>>>12)+s|0,n+=(i&a|s&~a)+t[5]-701558691|0,n=(n<<5|n>>>27)+i|0,a+=(n&s|i&~s)+t[10]+38016083|0,a=(a<<9|a>>>23)+n|0,s+=(a&i|n&~i)+t[15]-660478335|0,s=(s<<14|s>>>18)+a|0,i+=(s&n|a&~n)+t[4]-405537848|0,i=(i<<20|i>>>12)+s|0,n+=(i&a|s&~a)+t[9]+568446438|0,n=(n<<5|n>>>27)+i|0,a+=(n&s|i&~s)+t[14]-1019803690|0,a=(a<<9|a>>>23)+n|0,s+=(a&i|n&~i)+t[3]-187363961|0,s=(s<<14|s>>>18)+a|0,i+=(s&n|a&~n)+t[8]+1163531501|0,i=(i<<20|i>>>12)+s|0,n+=(i&a|s&~a)+t[13]-1444681467|0,n=(n<<5|n>>>27)+i|0,a+=(n&s|i&~s)+t[2]-51403784|0,a=(a<<9|a>>>23)+n|0,s+=(a&i|n&~i)+t[7]+1735328473|0,s=(s<<14|s>>>18)+a|0,i+=(s&n|a&~n)+t[12]-1926607734|0,i=(i<<20|i>>>12)+s|0,n+=(i^s^a)+t[5]-378558|0,n=(n<<4|n>>>28)+i|0,a+=(n^i^s)+t[8]-2022574463|0,a=(a<<11|a>>>21)+n|0,s+=(a^n^i)+t[11]+1839030562|0,s=(s<<16|s>>>16)+a|0,i+=(s^a^n)+t[14]-35309556|0,i=(i<<23|i>>>9)+s|0,n+=(i^s^a)+t[1]-1530992060|0,n=(n<<4|n>>>28)+i|0,a+=(n^i^s)+t[4]+1272893353|0,a=(a<<11|a>>>21)+n|0,s+=(a^n^i)+t[7]-155497632|0,s=(s<<16|s>>>16)+a|0,i+=(s^a^n)+t[10]-1094730640|0,i=(i<<23|i>>>9)+s|0,n+=(i^s^a)+t[13]+681279174|0,n=(n<<4|n>>>28)+i|0,a+=(n^i^s)+t[0]-358537222|0,a=(a<<11|a>>>21)+n|0,s+=(a^n^i)+t[3]-722521979|0,s=(s<<16|s>>>16)+a|0,i+=(s^a^n)+t[6]+76029189|0,i=(i<<23|i>>>9)+s|0,n+=(i^s^a)+t[9]-640364487|0,n=(n<<4|n>>>28)+i|0,a+=(n^i^s)+t[12]-421815835|0,a=(a<<11|a>>>21)+n|0,s+=(a^n^i)+t[15]+530742520|0,s=(s<<16|s>>>16)+a|0,i+=(s^a^n)+t[2]-995338651|0,i=(i<<23|i>>>9)+s|0,n+=(s^(i|~a))+t[0]-198630844|0,n=(n<<6|n>>>26)+i|0,a+=(i^(n|~s))+t[7]+1126891415|0,a=(a<<10|a>>>22)+n|0,s+=(n^(a|~i))+t[14]-1416354905|0,s=(s<<15|s>>>17)+a|0,i+=(a^(s|~n))+t[5]-57434055|0,i=(i<<21|i>>>11)+s|0,n+=(s^(i|~a))+t[12]+1700485571|0,n=(n<<6|n>>>26)+i|0,a+=(i^(n|~s))+t[3]-1894986606|0,a=(a<<10|a>>>22)+n|0,s+=(n^(a|~i))+t[10]-1051523|0,s=(s<<15|s>>>17)+a|0,i+=(a^(s|~n))+t[1]-2054922799|0,i=(i<<21|i>>>11)+s|0,n+=(s^(i|~a))+t[8]+1873313359|0,n=(n<<6|n>>>26)+i|0,a+=(i^(n|~s))+t[15]-30611744|0,a=(a<<10|a>>>22)+n|0,s+=(n^(a|~i))+t[6]-1560198380|0,s=(s<<15|s>>>17)+a|0,i+=(a^(s|~n))+t[13]+1309151649|0,i=(i<<21|i>>>11)+s|0,n+=(s^(i|~a))+t[4]-145523070|0,n=(n<<6|n>>>26)+i|0,a+=(i^(n|~s))+t[11]-1120210379|0,a=(a<<10|a>>>22)+n|0,s+=(n^(a|~i))+t[2]+718787259|0,s=(s<<15|s>>>17)+a|0,i+=(a^(s|~n))+t[9]-343485551|0,i=(i<<21|i>>>11)+s|0,e[0]=n+e[0]|0,e[1]=i+e[1]|0,e[2]=s+e[2]|0,e[3]=a+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(le.stateIdentity),this}appendStr(e){let t=this._buffer8,n=this._buffer32,i=this._bufferLength,s,a;for(a=0;a<e.length;a+=1){if(s=e.charCodeAt(a),s<128)t[i++]=s;else if(s<2048)t[i++]=(s>>>6)+192,t[i++]=s&63|128;else if(s<55296||s>56319)t[i++]=(s>>>12)+224,t[i++]=s>>>6&63|128,t[i++]=s&63|128;else{if(s=(s-55296)*1024+(e.charCodeAt(++a)-56320)+65536,s>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[i++]=(s>>>18)+240,t[i++]=s>>>12&63|128,t[i++]=s>>>6&63|128,t[i++]=s&63|128}i>=64&&(this._dataLength+=64,le._md5cycle(this._state,n),i-=64,n[0]=n[16])}return this._bufferLength=i,this}appendAsciiStr(e){let t=this._buffer8,n=this._buffer32,i=this._bufferLength,s,a=0;for(;;){for(s=Math.min(e.length-a,64-i);s--;)t[i++]=e.charCodeAt(a++);if(i<64)break;this._dataLength+=64,le._md5cycle(this._state,n),i=0}return this._bufferLength=i,this}appendByteArray(e){let t=this._buffer8,n=this._buffer32,i=this._bufferLength,s,a=0;for(;;){for(s=Math.min(e.length-a,64-i);s--;)t[i++]=e[a++];if(i<64)break;this._dataLength+=64,le._md5cycle(this._state,n),i=0}return this._bufferLength=i,this}getState(){let e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){let t=e.buffer,n=e.state,i=this._state,s;for(this._dataLength=e.length,this._bufferLength=e.buflen,i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],s=0;s<t.length;s+=1)this._buffer8[s]=t.charCodeAt(s)}end(e=!1){let t=this._bufferLength,n=this._buffer8,i=this._buffer32,s=(t>>2)+1;this._dataLength+=t;let a=this._dataLength*8;if(n[t]=128,n[t+1]=n[t+2]=n[t+3]=0,i.set(le.buffer32Identity.subarray(s),s),t>55&&(le._md5cycle(this._state,i),i.set(le.buffer32Identity)),a<=4294967295)i[14]=a;else{let u=a.toString(16).match(/(.*?)(.{0,8})$/);if(u===null)return;let c=parseInt(u[2],16),h=parseInt(u[1],16)||0;i[14]=c,i[15]=h}return le._md5cycle(this._state,i),e?this._state:le._hex(this._state)}},xe=le;o(xe,"Md5"),g(xe,"stateIdentity",new Int32Array([1732584193,-271733879,-1732584194,271733878])),g(xe,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),g(xe,"hexChars","0123456789abcdef"),g(xe,"hexOut",[]),g(xe,"onePassHasher",new le)});var Pr={};we(Pr,{createHash:()=>uo,createHmac:()=>co,randomBytes:()=>oo});function oo(r){return S.getRandomValues(y.alloc(r))}function uo(r){if(r==="sha256")return{update:function(e){return{digest:function(){return y.from(st(e))}}}};if(r==="md5")return{update:function(e){return{digest:function(){return typeof e=="string"?xe.hashStr(e):xe.hashByteArray(e)}}}};throw new Error(`Hash type '${r}' not supported`)}function co(r,e){if(r!=="sha256")throw new Error(`Only sha256 is supported (requested: '${r}')`);return{update:function(t){return{digest:function(){typeof e=="string"&&(e=new TextEncoder().encode(e)),typeof t=="string"&&(t=new TextEncoder().encode(t));let n=e.length;if(n>64)e=st(e);else if(n<64){let c=new Uint8Array(64);c.set(e),e=c}let i=new Uint8Array(64),s=new Uint8Array(64);for(let c=0;c<64;c++)i[c]=54^e[c],s[c]=92^e[c];let a=new Uint8Array(t.length+64);a.set(i,0),a.set(t,64);let u=new Uint8Array(64+32);return u.set(s,0),u.set(st(a),64),y.from(st(u))}}}}}var Rr=ne(()=>{p();Zn();Xn();o(oo,"randomBytes");o(uo,"createHash");o(co,"createHmac")});var Fr=T(ei=>{"use strict";p();ei.parse=function(r,e){return new je(r,e).parse()};var je=class{constructor(e,t){this.source=e,this.transform=t||ho,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return e==="\\"?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var t;(this.recorded.length>0||e)&&(t=this.recorded.join(""),t==="NULL"&&!e&&(t=null),t!==null&&(t=this.transform(t)),this.entries.push(t),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var e=this.nextCharacter();if(e.value==="=")break}}parse(e){var t,n,i;for(this.consumeDimensions();!this.isEof();)if(t=this.nextCharacter(),t.value==="{"&&!i)this.dimension++,this.dimension>1&&(n=new je(this.source.substr(this.position-1),this.transform),this.entries.push(n.parse(!0)),this.position+=n.position-2);else if(t.value==="}"&&!i){if(this.dimension--,!this.dimension&&(this.newEntry(),e))return this.entries}else t.value==='"'&&!t.escaped?(i&&this.newEntry(!0),i=!i):t.value===","&&!i?this.newEntry():this.record(t.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};o(je,"ArrayParser");function ho(r){return r}o(ho,"identity")});var Mr=T((ul,ti)=>{p();var lo=Fr();ti.exports={create:function(r,e){return{parse:function(){return lo.parse(r,e)}}}}});var ii=T((hl,ni)=>{"use strict";p();var fo=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,po=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,yo=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,wo=/^-?infinity$/;ni.exports=o(function(e){if(wo.test(e))return Number(e.replace("i","I"));var t=fo.exec(e);if(!t)return mo(e)||null;var n=!!t[8],i=parseInt(t[1],10);n&&(i=ri(i));var s=parseInt(t[2],10)-1,a=t[3],u=parseInt(t[4],10),c=parseInt(t[5],10),h=parseInt(t[6],10),l=t[7];l=l?1e3*parseFloat(l):0;var f,m=go(e);return m!=null?(f=new Date(Date.UTC(i,s,a,u,c,h,l)),kr(i)&&f.setUTCFullYear(i),m!==0&&f.setTime(f.getTime()-m)):(f=new Date(i,s,a,u,c,h,l),kr(i)&&f.setFullYear(i)),f},"parseDate");function mo(r){var e=po.exec(r);if(!!e){var t=parseInt(e[1],10),n=!!e[4];n&&(t=ri(t));var i=parseInt(e[2],10)-1,s=e[3],a=new Date(t,i,s);return kr(t)&&a.setFullYear(t),a}}o(mo,"getDate");function go(r){if(r.endsWith("+00"))return 0;var e=yo.exec(r.split(" ")[1]);if(!!e){var t=e[1];if(t==="Z")return 0;var n=t==="-"?-1:1,i=parseInt(e[2],10)*3600+parseInt(e[3]||0,10)*60+parseInt(e[4]||0,10);return i*n*1e3}}o(go,"timeZoneOffset");function ri(r){return-(r-1)}o(ri,"bcYearToNegativeYear");function kr(r){return r>=0&&r<100}o(kr,"is0To99")});var ai=T((dl,si)=>{p();si.exports=bo;var So=Object.prototype.hasOwnProperty;function bo(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)So.call(t,n)&&(r[n]=t[n])}return r}o(bo,"extend")});var ci=T((wl,ui)=>{"use strict";p();var xo=ai();ui.exports=Ke;function Ke(r){if(!(this instanceof Ke))return new Ke(r);xo(this,Ro(r))}o(Ke,"PostgresInterval");var Ao=["seconds","minutes","hours","days","months","years"];Ke.prototype.toPostgres=function(){var r=Ao.filter(this.hasOwnProperty,this);return this.milliseconds&&r.indexOf("seconds")<0&&r.push("seconds"),r.length===0?"0":r.map(function(e){var t=this[e]||0;return e==="seconds"&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),t+" "+e},this).join(" ")};var vo={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},Eo=["years","months","days"],_o=["hours","minutes","seconds"];Ke.prototype.toISOString=Ke.prototype.toISO=function(){var r=Eo.map(t,this).join(""),e=_o.map(t,this).join("");return"P"+r+"T"+e;function t(n){var i=this[n]||0;return n==="seconds"&&this.milliseconds&&(i=(i+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),i+vo[n]}};var Nr="([+-]?\\d+)",Uo=Nr+"\\s+years?",Co=Nr+"\\s+mons?",Io=Nr+"\\s+days?",Lo="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",To=new RegExp([Uo,Co,Io,Lo].map(function(r){return"("+r+")?"}).join("\\s*")),oi={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},Bo=["hours","minutes","seconds","milliseconds"];function Po(r){var e=r+"000000".slice(r.length);return parseInt(e,10)/1e3}o(Po,"parseMilliseconds");function Ro(r){if(!r)return{};var e=To.exec(r),t=e[8]==="-";return Object.keys(oi).reduce(function(n,i){var s=oi[i],a=e[s];return!a||(a=i==="milliseconds"?Po(a):parseInt(a,10),!a)||(t&&~Bo.indexOf(i)&&(a*=-1),n[i]=a),n},{})}o(Ro,"parse")});var li=T((Sl,hi)=>{"use strict";p();hi.exports=o(function(e){if(/^\\x/.test(e))return new y(e.substr(2),"hex");for(var t="",n=0;n<e.length;)if(e[n]!=="\\")t+=e[n],++n;else if(/[0-7]{3}/.test(e.substr(n+1,3)))t+=String.fromCharCode(parseInt(e.substr(n+1,3),8)),n+=4;else{for(var i=1;n+i<e.length&&e[n+i]==="\\";)i++;for(var s=0;s<Math.floor(i/2);++s)t+="\\";n+=Math.floor(i/2)*2}return new y(t,"binary")},"parseBytea")});var gi=T((Al,mi)=>{p();var at=Fr(),ot=Mr(),Lt=ii(),di=ci(),pi=li();function Tt(r){return o(function(t){return t===null?t:r(t)},"nullAllowed")}o(Tt,"allowNull");function yi(r){return r===null?r:r==="TRUE"||r==="t"||r==="true"||r==="y"||r==="yes"||r==="on"||r==="1"}o(yi,"parseBool");function Fo(r){return r?at.parse(r,yi):null}o(Fo,"parseBoolArray");function Mo(r){return parseInt(r,10)}o(Mo,"parseBaseTenInt");function Dr(r){return r?at.parse(r,Tt(Mo)):null}o(Dr,"parseIntegerArray");function ko(r){return r?at.parse(r,Tt(function(e){return wi(e).trim()})):null}o(ko,"parseBigIntegerArray");var No=o(function(r){if(!r)return null;var e=ot.create(r,function(t){return t!==null&&(t=Hr(t)),t});return e.parse()},"parsePointArray"),qr=o(function(r){if(!r)return null;var e=ot.create(r,function(t){return t!==null&&(t=parseFloat(t)),t});return e.parse()},"parseFloatArray"),ge=o(function(r){if(!r)return null;var e=ot.create(r);return e.parse()},"parseStringArray"),Or=o(function(r){if(!r)return null;var e=ot.create(r,function(t){return t!==null&&(t=Lt(t)),t});return e.parse()},"parseDateArray"),Do=o(function(r){if(!r)return null;var e=ot.create(r,function(t){return t!==null&&(t=di(t)),t});return e.parse()},"parseIntervalArray"),qo=o(function(r){return r?at.parse(r,Tt(pi)):null},"parseByteAArray"),Qr=o(function(r){return parseInt(r,10)},"parseInteger"),wi=o(function(r){var e=String(r);return/^\d+$/.test(e)?e:r},"parseBigInteger"),fi=o(function(r){return r?at.parse(r,Tt(JSON.parse)):null},"parseJsonArray"),Hr=o(function(r){return r[0]!=="("?null:(r=r.substring(1,r.length-1).split(","),{x:parseFloat(r[0]),y:parseFloat(r[1])})},"parsePoint"),Oo=o(function(r){if(r[0]!=="<"&&r[1]!=="(")return null;for(var e="(",t="",n=!1,i=2;i<r.length-1;i++){if(n||(e+=r[i]),r[i]===")"){n=!0;continue}else if(!n)continue;r[i]!==","&&(t+=r[i])}var s=Hr(e);return s.radius=parseFloat(t),s},"parseCircle"),Qo=o(function(r){r(20,wi),r(21,Qr),r(23,Qr),r(26,Qr),r(700,parseFloat),r(701,parseFloat),r(16,yi),r(1082,Lt),r(1114,Lt),r(1184,Lt),r(600,Hr),r(651,ge),r(718,Oo),r(1e3,Fo),r(1001,qo),r(1005,Dr),r(1007,Dr),r(1028,Dr),r(1016,ko),r(1017,No),r(1021,qr),r(1022,qr),r(1231,qr),r(1014,ge),r(1015,ge),r(1008,ge),r(1009,ge),r(1040,ge),r(1041,ge),r(1115,Or),r(1182,Or),r(1185,Or),r(1186,di),r(1187,Do),r(17,pi),r(114,JSON.parse.bind(JSON)),r(3802,JSON.parse.bind(JSON)),r(199,fi),r(3807,fi),r(3907,ge),r(2951,ge),r(791,ge),r(1183,ge),r(1270,ge)},"init");mi.exports={init:Qo}});var bi=T((_l,Si)=>{"use strict";p();var fe=1e6;function Ho(r){var e=r.readInt32BE(0),t=r.readUInt32BE(4),n="";e<0&&(e=~e+(t===0),t=~t+1>>>0,n="-");var i="",s,a,u,c,h,l;{if(s=e%fe,e=e/fe>>>0,a=4294967296*s+t,t=a/fe>>>0,u=""+(a-fe*t),t===0&&e===0)return n+u+i;for(c="",h=6-u.length,l=0;l<h;l++)c+="0";i=c+u+i}{if(s=e%fe,e=e/fe>>>0,a=4294967296*s+t,t=a/fe>>>0,u=""+(a-fe*t),t===0&&e===0)return n+u+i;for(c="",h=6-u.length,l=0;l<h;l++)c+="0";i=c+u+i}{if(s=e%fe,e=e/fe>>>0,a=4294967296*s+t,t=a/fe>>>0,u=""+(a-fe*t),t===0&&e===0)return n+u+i;for(c="",h=6-u.length,l=0;l<h;l++)c+="0";i=c+u+i}return s=e%fe,a=4294967296*s+t,u=""+a%fe,n+u+i}o(Ho,"readInt8");Si.exports=Ho});var _i=T((Il,Ei)=>{p();var jo=bi(),Q=o(function(r,e,t,n,i){t=t||0,n=n||!1,i=i||function(b,_,L){return b*Math.pow(2,L)+_};var s=t>>3,a=o(function(b){return n?~b&255:b},"inv"),u=255,c=8-t%8;e<c&&(u=255<<8-e&255,c=e),t&&(u=u>>t%8);var h=0;t%8+e>=8&&(h=i(0,a(r[s])&u,c));for(var l=e+t>>3,f=s+1;f<l;f++)h=i(h,a(r[f]),8);var m=(e+t)%8;return m>0&&(h=i(h,a(r[l])>>8-m,m)),h},"parseBits"),vi=o(function(r,e,t){var n=Math.pow(2,t-1)-1,i=Q(r,1),s=Q(r,t,1);if(s===0)return 0;var a=1,u=o(function(h,l,f){h===0&&(h=1);for(var m=1;m<=f;m++)a/=2,(l&1<<f-m)>0&&(h+=a);return h},"parsePrecisionBits"),c=Q(r,e,t+1,!1,u);return s==Math.pow(2,t+1)-1?c===0?i===0?1/0:-1/0:NaN:(i===0?1:-1)*Math.pow(2,s-n)*c},"parseFloatFromBits"),Ko=o(function(r){return Q(r,1)==1?-1*(Q(r,15,1,!0)+1):Q(r,15,1)},"parseInt16"),xi=o(function(r){return Q(r,1)==1?-1*(Q(r,31,1,!0)+1):Q(r,31,1)},"parseInt32"),$o=o(function(r){return vi(r,23,8)},"parseFloat32"),Wo=o(function(r){return vi(r,52,11)},"parseFloat64"),Vo=o(function(r){var e=Q(r,16,32);if(e==49152)return NaN;for(var t=Math.pow(1e4,Q(r,16,16)),n=0,i=[],s=Q(r,16),a=0;a<s;a++)n+=Q(r,16,64+16*a)*t,t/=1e4;var u=Math.pow(10,Q(r,16,48));return(e===0?1:-1)*Math.round(n*u)/u},"parseNumeric"),Ai=o(function(r,e){var t=Q(e,1),n=Q(e,63,1),i=new Date((t===0?1:-1)*n/1e3+9466848e5);return r||i.setTime(i.getTime()+i.getTimezoneOffset()*6e4),i.usec=n%1e3,i.getMicroSeconds=function(){return this.usec},i.setMicroSeconds=function(s){this.usec=s},i.getUTCMicroSeconds=function(){return this.usec},i},"parseDate"),ut=o(function(r){for(var e=Q(r,32),t=Q(r,32,32),n=Q(r,32,64),i=96,s=[],a=0;a<e;a++)s[a]=Q(r,32,i),i+=32,i+=32;var u=o(function(h){var l=Q(r,32,i);if(i+=32,l==4294967295)return null;var f;if(h==23||h==20)return f=Q(r,l*8,i),i+=l*8,f;if(h==25)return f=r.toString(this.encoding,i>>3,(i+=l<<3)>>3),f;console.log("ERROR: ElementType not implemented: "+h)},"parseElement"),c=o(function(h,l){var f=[],m;if(h.length>1){var b=h.shift();for(m=0;m<b;m++)f[m]=c(h,l);h.unshift(b)}else for(m=0;m<h[0];m++)f[m]=u(l);return f},"parse");return c(s,n)},"parseArray"),Go=o(function(r){return r.toString("utf8")},"parseText"),zo=o(function(r){return r===null?null:Q(r,8)>0},"parseBool"),Yo=o(function(r){r(20,jo),r(21,Ko),r(23,xi),r(26,xi),r(1700,Vo),r(700,$o),r(701,Wo),r(16,zo),r(1114,Ai.bind(null,!1)),r(1184,Ai.bind(null,!0)),r(1e3,ut),r(1007,ut),r(1016,ut),r(1008,ut),r(1009,ut),r(25,Go)},"init");Ei.exports={init:Yo}});var Ci=T((Bl,Ui)=>{p();Ui.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var lt=T(ht=>{p();var Jo=gi(),Zo=_i(),Xo=Mr(),eu=Ci();ht.getTypeParser=tu;ht.setTypeParser=ru;ht.arrayParser=Xo;ht.builtins=eu;var ct={text:{},binary:{}};function Ii(r){return String(r)}o(Ii,"noParse");function tu(r,e){return e=e||"text",ct[e]&&ct[e][r]||Ii}o(tu,"getTypeParser");function ru(r,e,t){typeof e=="function"&&(t=e,e="text"),ct[e][r]=t}o(ru,"setTypeParser");Jo.init(function(r,e){ct.text[r]=e});Zo.init(function(r,e){ct.binary[r]=e})});var ft=T((kl,jr)=>{"use strict";p();jr.exports={host:"localhost",user:w.platform==="win32"?w.env.USERNAME:w.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var $e=lt(),nu=$e.getTypeParser(20,"text"),iu=$e.getTypeParser(1016,"text");jr.exports.__defineSetter__("parseInt8",function(r){$e.setTypeParser(20,"text",r?$e.getTypeParser(23,"text"):nu),$e.setTypeParser(1016,"text",r?$e.getTypeParser(1007,"text"):iu)})});var dt=T((Dl,Ti)=>{"use strict";p();var su=(Rr(),Y(Pr)),au=ft();function ou(r){var e=r.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+e+'"'}o(ou,"escapeElement");function Li(r){for(var e="{",t=0;t<r.length;t++)t>0&&(e=e+","),r[t]===null||typeof r[t]>"u"?e=e+"NULL":Array.isArray(r[t])?e=e+Li(r[t]):r[t]instanceof y?e+="\\\\x"+r[t].toString("hex"):e+=ou(Bt(r[t]));return e=e+"}",e}o(Li,"arrayString");var Bt=o(function(r,e){if(r==null)return null;if(r instanceof y)return r;if(ArrayBuffer.isView(r)){var t=y.from(r.buffer,r.byteOffset,r.byteLength);return t.length===r.byteLength?t:t.slice(r.byteOffset,r.byteOffset+r.byteLength)}return r instanceof Date?au.parseInputDatesAsUTC?hu(r):cu(r):Array.isArray(r)?Li(r):typeof r=="object"?uu(r,e):r.toString()},"prepareValue");function uu(r,e){if(r&&typeof r.toPostgres=="function"){if(e=e||[],e.indexOf(r)!==-1)throw new Error('circular reference detected while preparing "'+r+'" for query');return e.push(r),Bt(r.toPostgres(Bt),e)}return JSON.stringify(r)}o(uu,"prepareObject");function ie(r,e){for(r=""+r;r.length<e;)r="0"+r;return r}o(ie,"pad");function cu(r){var e=-r.getTimezoneOffset(),t=r.getFullYear(),n=t<1;n&&(t=Math.abs(t)+1);var i=ie(t,4)+"-"+ie(r.getMonth()+1,2)+"-"+ie(r.getDate(),2)+"T"+ie(r.getHours(),2)+":"+ie(r.getMinutes(),2)+":"+ie(r.getSeconds(),2)+"."+ie(r.getMilliseconds(),3);return e<0?(i+="-",e*=-1):i+="+",i+=ie(Math.floor(e/60),2)+":"+ie(e%60,2),n&&(i+=" BC"),i}o(cu,"dateToString");function hu(r){var e=r.getUTCFullYear(),t=e<1;t&&(e=Math.abs(e)+1);var n=ie(e,4)+"-"+ie(r.getUTCMonth()+1,2)+"-"+ie(r.getUTCDate(),2)+"T"+ie(r.getUTCHours(),2)+":"+ie(r.getUTCMinutes(),2)+":"+ie(r.getUTCSeconds(),2)+"."+ie(r.getUTCMilliseconds(),3);return n+="+00:00",t&&(n+=" BC"),n}o(hu,"dateToStringUTC");function lu(r,e,t){return r=typeof r=="string"?{text:r}:r,e&&(typeof e=="function"?r.callback=e:r.values=e),t&&(r.callback=t),r}o(lu,"normalizeQueryConfig");var Kr=o(function(r){return su.createHash("md5").update(r,"utf-8").digest("hex")},"md5"),fu=o(function(r,e,t){var n=Kr(e+r),i=Kr(y.concat([y.from(n),t]));return"md5"+i},"postgresMd5PasswordHash");Ti.exports={prepareValue:o(function(e){return Bt(e)},"prepareValueWrapper"),normalizeQueryConfig:lu,postgresMd5PasswordHash:fu,md5:Kr}});var Le=T((Wl,$r)=>{"use strict";p();var Ve=typeof Reflect=="object"?Reflect:null,Pi=Ve&&typeof Ve.apply=="function"?Ve.apply:o(function(e,t,n){return Function.prototype.apply.call(e,t,n)},"ReflectApply"),Rt;Ve&&typeof Ve.ownKeys=="function"?Rt=Ve.ownKeys:Object.getOwnPropertySymbols?Rt=o(function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))},"ReflectOwnKeys"):Rt=o(function(e){return Object.getOwnPropertyNames(e)},"ReflectOwnKeys");function du(r){console&&console.warn&&console.warn(r)}o(du,"ProcessEmitWarning");var Fi=Number.isNaN||o(function(e){return e!==e},"NumberIsNaN");function M(){M.init.call(this)}o(M,"EventEmitter");$r.exports=M;$r.exports.once=mu;M.EventEmitter=M;M.prototype._events=void 0;M.prototype._eventsCount=0;M.prototype._maxListeners=void 0;var Ri=10;function Ft(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}o(Ft,"checkListener");Object.defineProperty(M,"defaultMaxListeners",{enumerable:!0,get:function(){return Ri},set:function(r){if(typeof r!="number"||r<0||Fi(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Ri=r}});M.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};M.prototype.setMaxListeners=o(function(e){if(typeof e!="number"||e<0||Fi(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},"setMaxListeners");function Mi(r){return r._maxListeners===void 0?M.defaultMaxListeners:r._maxListeners}o(Mi,"_getMaxListeners");M.prototype.getMaxListeners=o(function(){return Mi(this)},"getMaxListeners");M.prototype.emit=o(function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var u=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw u.context=a,u}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")Pi(c,this,t);else for(var h=c.length,l=Oi(c,h),n=0;n<h;++n)Pi(l[n],this,t);return!0},"emit");function ki(r,e,t,n){var i,s,a;if(Ft(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),a=s[e]),a===void 0)a=s[e]=t,++r._eventsCount;else if(typeof a=="function"?a=s[e]=n?[t,a]:[a,t]:n?a.unshift(t):a.push(t),i=Mi(r),i>0&&a.length>i&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=r,u.type=e,u.count=a.length,du(u)}return r}o(ki,"_addListener");M.prototype.addListener=o(function(e,t){return ki(this,e,t,!1)},"addListener");M.prototype.on=M.prototype.addListener;M.prototype.prependListener=o(function(e,t){return ki(this,e,t,!0)},"prependListener");function pu(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}o(pu,"onceWrapper");function Ni(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=pu.bind(n);return i.listener=t,n.wrapFn=i,i}o(Ni,"_onceWrap");M.prototype.once=o(function(e,t){return Ft(t),this.on(e,Ni(this,e,t)),this},"once");M.prototype.prependOnceListener=o(function(e,t){return Ft(t),this.prependListener(e,Ni(this,e,t)),this},"prependOnceListener");M.prototype.removeListener=o(function(e,t){var n,i,s,a,u;if(Ft(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){u=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():yu(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,u||t)}return this},"removeListener");M.prototype.off=M.prototype.removeListener;M.prototype.removeAllListeners=o(function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},"removeAllListeners");function Di(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?wu(i):Oi(i,i.length)}o(Di,"_listeners");M.prototype.listeners=o(function(e){return Di(this,e,!0)},"listeners");M.prototype.rawListeners=o(function(e){return Di(this,e,!1)},"rawListeners");M.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):qi.call(r,e)};M.prototype.listenerCount=qi;function qi(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}o(qi,"listenerCount");M.prototype.eventNames=o(function(){return this._eventsCount>0?Rt(this._events):[]},"eventNames");function Oi(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}o(Oi,"arrayClone");function yu(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}o(yu,"spliceOne");function wu(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}o(wu,"unwrapListeners");function mu(r,e){return new Promise(function(t,n){function i(a){r.removeListener(e,s),n(a)}o(i,"errorListener");function s(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}o(s,"resolver"),Qi(r,e,s,{once:!0}),e!=="error"&&gu(r,i,{once:!0})})}o(mu,"once");function gu(r,e,t){typeof r.on=="function"&&Qi(r,"error",e,t)}o(gu,"addErrorHandlerIfEventEmitter");function Qi(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,o(function i(s){n.once&&r.removeEventListener(e,i),t(s)},"wrapListener"));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}o(Qi,"eventTargetAgnosticAddListener")});var pt={};we(pt,{default:()=>Su});var Su,yt=ne(()=>{p();Su={}});var Wi=T((Yl,$i)=>{"use strict";p();var Wr=(Rr(),Y(Pr));function bu(r){if(r.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let e=Wr.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:e,response:"n,,n=*,r="+e,message:"SASLInitialResponse"}}o(bu,"startSession");function xu(r,e,t){if(r.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof t!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let n=Eu(t);if(n.nonce.startsWith(r.clientNonce)){if(n.nonce.length===r.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var i=y.from(n.salt,"base64"),s=Cu(e,i,n.iteration),a=Ge(s,"Client Key"),u=Uu(a),c="n=*,r="+r.clientNonce,h="r="+n.nonce+",s="+n.salt+",i="+n.iteration,l="c=biws,r="+n.nonce,f=c+","+h+","+l,m=Ge(u,f),b=Ki(a,m),_=b.toString("base64"),L=Ge(s,"Server Key"),A=Ge(L,f);r.message="SASLResponse",r.serverSignature=A.toString("base64"),r.response=l+",p="+_}o(xu,"continueSession");function Au(r,e){if(r.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:t}=_u(e);if(t!==r.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}o(Au,"finalizeSession");function vu(r){if(typeof r!="string")throw new TypeError("SASL: text must be a string");return r.split("").map((e,t)=>r.charCodeAt(t)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}o(vu,"isPrintableChars");function Hi(r){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(r)}o(Hi,"isBase64");function ji(r){if(typeof r!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(r.split(",").map(e=>{if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");let t=e[0],n=e.substring(2);return[t,n]}))}o(ji,"parseAttributePairs");function Eu(r){let e=ji(r),t=e.get("r");if(t){if(!vu(t))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let n=e.get("s");if(n){if(!Hi(n))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let i=e.get("i");if(i){if(!/^[1-9][0-9]*$/.test(i))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let s=parseInt(i,10);return{nonce:t,salt:n,iteration:s}}o(Eu,"parseServerFirstMessage");function _u(r){let t=ji(r).get("v");if(t){if(!Hi(t))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:t}}o(_u,"parseServerFinalMessage");function Ki(r,e){if(!y.isBuffer(r))throw new TypeError("first argument must be a Buffer");if(!y.isBuffer(e))throw new TypeError("second argument must be a Buffer");if(r.length!==e.length)throw new Error("Buffer lengths must match");if(r.length===0)throw new Error("Buffers cannot be empty");return y.from(r.map((t,n)=>r[n]^e[n]))}o(Ki,"xorBuffers");function Uu(r){return Wr.createHash("sha256").update(r).digest()}o(Uu,"sha256");function Ge(r,e){return Wr.createHmac("sha256",r).update(e).digest()}o(Ge,"hmacSha256");function Cu(r,e,t){for(var n=Ge(r,y.concat([e,y.from([0,0,0,1])])),i=n,s=0;s<t-1;s++)n=Ge(r,n),i=Ki(i,n);return i}o(Cu,"Hi");$i.exports={startSession:bu,continueSession:xu,finalizeSession:Au}});var Vr={};we(Vr,{join:()=>Iu});function Iu(...r){return r.join("/")}var Gr=ne(()=>{p();o(Iu,"join")});var zr={};we(zr,{stat:()=>Lu});function Lu(r,e){e(new Error("No filesystem"))}var Yr=ne(()=>{p();o(Lu,"stat")});var Jr={};we(Jr,{default:()=>Tu});var Tu,Zr=ne(()=>{p();Tu={}});var Vi={};we(Vi,{StringDecoder:()=>Mt});var Mt,Gi=ne(()=>{p();Mt=class{constructor(e){this.td=new TextDecoder(e)}write(e){return this.td.decode(e,{stream:!0})}end(e){return this.td.decode(e)}};o(Mt,"StringDecoder")});var Zi=T((of,Ji)=>{"use strict";p();var{Transform:Bu}=(Zr(),Y(Jr)),{StringDecoder:Pu}=(Gi(),Y(Vi)),Te=Symbol("last"),kt=Symbol("decoder");function Ru(r,e,t){let n;if(this.overflow){if(n=this[kt].write(r).split(this.matcher),n.length===1)return t();n.shift(),this.overflow=!1}else this[Te]+=this[kt].write(r),n=this[Te].split(this.matcher);this[Te]=n.pop();for(let i=0;i<n.length;i++)try{Yi(this,this.mapper(n[i]))}catch(s){return t(s)}if(this.overflow=this[Te].length>this.maxLength,this.overflow&&!this.skipOverflow){t(new Error("maximum buffer reached"));return}t()}o(Ru,"transform");function Fu(r){if(this[Te]+=this[kt].end(),this[Te])try{Yi(this,this.mapper(this[Te]))}catch(e){return r(e)}r()}o(Fu,"flush");function Yi(r,e){e!==void 0&&r.push(e)}o(Yi,"push");function zi(r){return r}o(zi,"noop");function Mu(r,e,t){switch(r=r||/\r?\n/,e=e||zi,t=t||{},arguments.length){case 1:typeof r=="function"?(e=r,r=/\r?\n/):typeof r=="object"&&!(r instanceof RegExp)&&!r[Symbol.split]&&(t=r,r=/\r?\n/);break;case 2:typeof r=="function"?(t=e,e=r,r=/\r?\n/):typeof e=="object"&&(t=e,e=zi)}t=Object.assign({},t),t.autoDestroy=!0,t.transform=Ru,t.flush=Fu,t.readableObjectMode=!0;let n=new Bu(t);return n[Te]="",n[kt]=new Pu("utf8"),n.matcher=r,n.mapper=e,n.maxLength=t.maxLength,n.skipOverflow=t.skipOverflow||!1,n.overflow=!1,n._destroy=function(i,s){this._writableState.errorEmitted=!1,s(i)},n}o(Mu,"split");Ji.exports=Mu});var ts=T((hf,Ce)=>{"use strict";p();var Xi=(Gr(),Y(Vr)),ku=(Zr(),Y(Jr)).Stream,Nu=Zi(),es=(yt(),Y(pt)),Du=5432,Nt=w.platform==="win32",wt=w.stderr,qu=56,Ou=7,Qu=61440,Hu=32768;function ju(r){return(r&Qu)==Hu}o(ju,"isRegFile");var ze=["host","port","database","user","password"],Xr=ze.length,Ku=ze[Xr-1];function en(){var r=wt instanceof ku&&wt.writable===!0;if(r){var e=Array.prototype.slice.call(arguments).concat(`
`);wt.write(es.format.apply(es,e))}}o(en,"warn");Object.defineProperty(Ce.exports,"isWin",{get:function(){return Nt},set:function(r){Nt=r}});Ce.exports.warnTo=function(r){var e=wt;return wt=r,e};Ce.exports.getFileName=function(r){var e=r||w.env,t=e.PGPASSFILE||(Nt?Xi.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xi.join(e.HOME||"./",".pgpass"));return t};Ce.exports.usePgPass=function(r,e){return Object.prototype.hasOwnProperty.call(w.env,"PGPASSWORD")?!1:Nt?!0:(e=e||"<unkn>",ju(r.mode)?r.mode&(qu|Ou)?(en('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(en('WARNING: password file "%s" is not a plain file',e),!1))};var $u=Ce.exports.match=function(r,e){return ze.slice(0,-1).reduce(function(t,n,i){return i==1&&Number(r[n]||Du)===Number(e[n])?t&&!0:t&&(e[n]==="*"||e[n]===r[n])},!0)};Ce.exports.getPassword=function(r,e,t){var n,i=e.pipe(Nu());function s(c){var h=Wu(c);h&&Vu(h)&&$u(r,h)&&(n=h[Ku],i.end())}o(s,"onLine");var a=o(function(){e.destroy(),t(n)},"onEnd"),u=o(function(c){e.destroy(),en("WARNING: error on reading file: %s",c),t(void 0)},"onErr");e.on("error",u),i.on("data",s).on("end",a).on("error",u)};var Wu=Ce.exports.parseLine=function(r){if(r.length<11||r.match(/^\s+#/))return null;for(var e="",t="",n=0,i=0,s=0,a={},u=!1,c=o(function(l,f,m){var b=r.substring(f,m);Object.hasOwnProperty.call(w.env,"PGPASS_NO_DEESCAPE")||(b=b.replace(/\\([:\\])/g,"$1")),a[ze[l]]=b},"addToObj"),h=0;h<r.length-1;h+=1){if(e=r.charAt(h+1),t=r.charAt(h),u=n==Xr-1,u){c(n,i);break}h>=0&&e==":"&&t!=="\\"&&(c(n,i,h+1),i=h+2,n+=1)}return a=Object.keys(a).length===Xr?a:null,a},Vu=Ce.exports.isValidEntry=function(r){for(var e={0:function(a){return a.length>0},1:function(a){return a==="*"?!0:(a=Number(a),isFinite(a)&&a>0&&a<9007199254740992&&Math.floor(a)===a)},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},t=0;t<ze.length;t+=1){var n=e[t],i=r[ze[t]]||"",s=n(i);if(!s)return!1}return!0}});var ns=T((pf,tn)=>{"use strict";p();var df=(Gr(),Y(Vr)),rs=(Yr(),Y(zr)),Dt=ts();tn.exports=function(r,e){var t=Dt.getFileName();rs.stat(t,function(n,i){if(n||!Dt.usePgPass(i,t))return e(void 0);var s=rs.createReadStream(t);Dt.getPassword(r,s,e)})};tn.exports.warnTo=Dt.warnTo});var rn=T((wf,is)=>{"use strict";p();var Gu=lt();function qt(r){this._types=r||Gu,this.text={},this.binary={}}o(qt,"TypeOverrides");qt.prototype.getOverrides=function(r){switch(r){case"text":return this.text;case"binary":return this.binary;default:return{}}};qt.prototype.setTypeParser=function(r,e,t){typeof e=="function"&&(t=e,e="text"),this.getOverrides(e)[r]=t};qt.prototype.getTypeParser=function(r,e){return e=e||"text",this.getOverrides(e)[r]||this._types.getTypeParser(r,e)};is.exports=qt});var ss={};we(ss,{default:()=>zu});var zu,as=ne(()=>{p();zu={}});var us=T((bf,os)=>{"use strict";p();function nn(r){if(r.charAt(0)==="/"){let u=r.split(" ");return{host:u[0],database:u[1]}}let e={},t,n=!1;/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(r)&&(r=encodeURI(r).replace(/\%25(\d\d)/g,"%$1"));try{t=new URL(r,"postgres://base")}catch{t=new URL(r.replace("@/","@___DUMMY___/"),"postgres://base"),n=!0}for(let u of t.searchParams.entries())e[u[0]]=u[1];if(e.user=e.user||decodeURIComponent(t.username),e.password=e.password||decodeURIComponent(t.password),e.port=t.port,t.protocol=="socket:")return e.host=decodeURI(t.pathname),e.database=t.searchParams.get("db"),e.client_encoding=t.searchParams.get("encoding"),e;let i=n?"":t.hostname;e.host?i&&(t.pathname=i+t.pathname):e.host=decodeURIComponent(i);let s=t.pathname.slice(1)||null;e.database=s?decodeURI(s):null,(e.ssl==="true"||e.ssl==="1")&&(e.ssl=!0),e.ssl==="0"&&(e.ssl=!1),(e.sslcert||e.sslkey||e.sslrootcert||e.sslmode)&&(e.ssl={});let a=e.sslcert||e.sslkey||e.sslrootcert?(Yr(),Y(zr)):null;switch(e.sslcert&&(e.ssl.cert=a.readFileSync(e.sslcert).toString()),e.sslkey&&(e.ssl.key=a.readFileSync(e.sslkey).toString()),e.sslrootcert&&(e.ssl.ca=a.readFileSync(e.sslrootcert).toString()),e.sslmode){case"disable":{e.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{e.ssl.rejectUnauthorized=!1;break}}return e}o(nn,"parse");os.exports=nn;nn.parse=nn});var Qt=T((vf,ls)=>{"use strict";p();var Yu=(as(),Y(ss)),hs=ft(),cs=us().parse,ce=o(function(r,e,t){return t===void 0?t=w.env["PG"+r.toUpperCase()]:t===!1||(t=w.env[t]),e[r]||t||hs[r]},"val"),Ju=o(function(){switch(w.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return hs.ssl},"readSSLConfigFromEnvironment"),Ye=o(function(r){return"'"+(""+r).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),Se=o(function(r,e,t){var n=e[t];n!=null&&r.push(t+"="+Ye(n))},"add"),Ot=class{constructor(e){e=typeof e=="string"?cs(e):e||{},e.connectionString&&(e=Object.assign({},e,cs(e.connectionString))),this.user=ce("user",e),this.database=ce("database",e),this.database===void 0&&(this.database=this.user),this.port=parseInt(ce("port",e),10),this.host=ce("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:ce("password",e)}),this.binary=ce("binary",e),this.options=ce("options",e),this.ssl=typeof e.ssl>"u"?Ju():e.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=ce("client_encoding",e),this.replication=ce("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=ce("application_name",e,"PGAPPNAME"),this.fallback_application_name=ce("fallback_application_name",e,!1),this.statement_timeout=ce("statement_timeout",e,!1),this.lock_timeout=ce("lock_timeout",e,!1),this.idle_in_transaction_session_timeout=ce("idle_in_transaction_session_timeout",e,!1),this.query_timeout=ce("query_timeout",e,!1),e.connectionTimeoutMillis===void 0?this.connect_timeout=w.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),e.keepAlive===!1?this.keepalives=0:e.keepAlive===!0&&(this.keepalives=1),typeof e.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){var t=[];Se(t,this,"user"),Se(t,this,"password"),Se(t,this,"port"),Se(t,this,"application_name"),Se(t,this,"fallback_application_name"),Se(t,this,"connect_timeout"),Se(t,this,"options");var n=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(Se(t,n,"sslmode"),Se(t,n,"sslca"),Se(t,n,"sslkey"),Se(t,n,"sslcert"),Se(t,n,"sslrootcert"),this.database&&t.push("dbname="+Ye(this.database)),this.replication&&t.push("replication="+Ye(this.replication)),this.host&&t.push("host="+Ye(this.host)),this.isDomainSocket)return e(null,t.join(" "));this.client_encoding&&t.push("client_encoding="+Ye(this.client_encoding)),Yu.lookup(this.host,function(i,s){return i?e(i,null):(t.push("hostaddr="+Ye(s)),e(null,t.join(" ")))})}};o(Ot,"ConnectionParameters");ls.exports=Ot});var ps=T((Uf,ds)=>{"use strict";p();var Zu=lt(),fs=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,Ht=class{constructor(e,t){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=t,this.RowCtor=null,this.rowAsArray=e==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(e){var t;e.text?t=fs.exec(e.text):t=fs.exec(e.command),t&&(this.command=t[1],t[3]?(this.oid=parseInt(t[2],10),this.rowCount=parseInt(t[3],10)):t[2]&&(this.rowCount=parseInt(t[2],10)))}_parseRowAsArray(e){for(var t=new Array(e.length),n=0,i=e.length;n<i;n++){var s=e[n];s!==null?t[n]=this._parsers[n](s):t[n]=null}return t}parseRow(e){for(var t={},n=0,i=e.length;n<i;n++){var s=e[n],a=this.fields[n].name;s!==null?t[a]=this._parsers[n](s):t[a]=null}return t}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=new Array(e.length));for(var t=0;t<e.length;t++){var n=e[t];this._types?this._parsers[t]=this._types.getTypeParser(n.dataTypeID,n.format||"text"):this._parsers[t]=Zu.getTypeParser(n.dataTypeID,n.format||"text")}}};o(Ht,"Result");ds.exports=Ht});var gs=T((Lf,ms)=>{"use strict";p();var{EventEmitter:Xu}=Le(),ys=ps(),ws=dt(),jt=class extends Xu{constructor(e,t,n){super(),e=ws.normalizeQueryConfig(e,t,n),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,w.domain&&e.callback&&(this.callback=w.domain.bind(e.callback)),this._result=new ys(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new ys(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let t;if(!this._canceledDueToError){try{t=this._result.parseRow(e.fields)}catch(n){this._canceledDueToError=n;return}this.emit("row",t,this._result),this._accumulateRows&&this._result.addRow(t)}}handleCommandComplete(e,t){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&t.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,t){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(t){w.nextTick(()=>{throw t})}this.emit("end",this._results)}submit(e){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let t=e.parsedStatements[this.name];return this.text&&t&&this.text!==t?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(e):e.query(this.text),null)}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,t){e.execute({portal:this.portal,rows:t}),t?e.flush():e.sync()}prepare(e){this.isPreparedStatement=!0,this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:ws.prepareValue})}catch(t){this.handleError(t,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,t){}};o(jt,"Query");ms.exports=jt});function ae(...r){if(r.length===1&&r[0]instanceof Uint8Array)return r[0];let e=r.reduce((i,s)=>i+s.length,0),t=new Uint8Array(e),n=0;for(let i of r)t.set(i,n),n+=i.length;return t}function St(r,e){let t=r.length;if(t!==e.length)return!1;for(let n=0;n<t;n++)if(r[n]!==e[n])return!1;return!0}function tc(r,e,t,n=!0){let i=new Ee(1024);i.writeUint8(22,0),i.writeUint16(769,0);let s=i.writeLengthUint16();i.writeUint8(1,0);let a=i.writeLengthUint24();i.writeUint16(771,0),S.getRandomValues(i.subarray(32));let u=i.writeLengthUint8(0);i.writeBytes(t),u();let c=i.writeLengthUint16(0);i.writeUint16(4865,0),c();let h=i.writeLengthUint8(0);i.writeUint8(0,0),h();let l=i.writeLengthUint16(0);if(n){i.writeUint16(0,0);let k=i.writeLengthUint16(0),J=i.writeLengthUint16(0);i.writeUint8(0,0);let N=i.writeLengthUint16(0);i.writeUTF8String(r),N(),J(),k()}i.writeUint16(11,0);let f=i.writeLengthUint16(0),m=i.writeLengthUint8(0);i.writeUint8(0,0),m(),f(),i.writeUint16(10,0);let b=i.writeLengthUint16(0),_=i.writeLengthUint16(0);i.writeUint16(23,0),_(),b(),i.writeUint16(13,0);let L=i.writeLengthUint16(0),A=i.writeLengthUint16(0);i.writeUint16(1027,0),i.writeUint16(2052,0),A(),L(),i.writeUint16(43,0);let P=i.writeLengthUint16(0),I=i.writeLengthUint8(0);i.writeUint16(772,0),I(),P(),i.writeUint16(51,0);let x=i.writeLengthUint16(0),D=i.writeLengthUint16(0);i.writeUint16(23,0);let W=i.writeLengthUint16(0);return i.writeBytes(new Uint8Array(e)),W(),D(),x(),l(),a(),s(),i}function Be(r,e=""){return[...r].map(t=>t.toString(16).padStart(2,"0")).join(e)}function rc(r,e){let t,n,[i]=r.expectLength(r.remaining());r.expectUint8(2,0);let[s]=r.expectLengthUint24(0);r.expectUint16(771,0);let a=r.readBytes(32);if(St(a,[207,33,173,116,229,154,97,17,190,29,140,2,30,101,184,145,194,162,17,22,122,187,140,94,7,158,9,226,200,168,51,156]))throw new Error("Unexpected HelloRetryRequest");r.expectUint8(e.length,0),r.expectBytes(e,0),r.expectUint16(4865,0),r.expectUint8(0,0);let[u,c]=r.expectLengthUint16(0);for(;c()>0;){let h=r.readUint16(0),[l]=r.expectLengthUint16(0);if(h===43)r.expectUint16(772,0),n=!0;else if(h===51)r.expectUint16(23,0),r.expectUint16(65),t=r.readBytes(65);else throw new Error(`Unexpected extension 0x${Be([h])}`);l()}if(u(),s(),i(),n!==!0)throw new Error("No TLS version provided");if(t===void 0)throw new Error("No key provided");return t}async function cn(r,e,t=mt){let n=await r(5);if(n===void 0)return;if(n.length<5)throw new Error("TLS record header truncated");let i=new Ee(n),s=i.readUint8();if(s<20||s>24)throw new Error(`Illegal TLS record type 0x${s.toString(16)}`);if(e!==void 0&&s!==e)throw new Error(`Unexpected TLS record type 0x${s.toString(16).padStart(2,"0")} (expected 0x${e.toString(16).padStart(2,"0")})`);i.expectUint16(771,"TLS record version 1.2 (middlebox compatibility)");let a=i.readUint16(0);if(a>t)throw new Error(`Record too long: ${a} bytes`);let u=await r(a);if(u===void 0||u.length<a)throw new Error("TLS record content truncated");return{headerData:n,header:i,type:s,length:a,content:u}}async function hn(r,e,t){let n=await cn(r,23,nc);if(n===void 0)return;let i=new Ee(n.content),[s]=i.expectLength(i.remaining());i.skip(n.length-16,0),i.skip(16,0),s();let a=await e.process(n.content,16,n.headerData),u=a.length-1;for(;a[u]===0;)u-=1;if(u<0)throw new Error("Decrypted message has no record type indicator (all zeroes)");let c=a[u],h=a.subarray(0,u);if(!(c===21&&h.length===2&&h[0]===1&&h[1]===0)){if(c===22&&h[0]===4)return hn(r,e,t);if(t!==void 0&&c!==t)throw new Error(`Unexpected TLS record type 0x${c.toString(16).padStart(2,"0")} (expected 0x${t.toString(16).padStart(2,"0")})`);return h}}async function ic(r,e,t){let n=ae(r,[t]),i=5,s=n.length+16,a=new Ee(i+s);a.writeUint8(23,0),a.writeUint16(771,0),a.writeUint16(s,`${s} bytes follow`);let[u]=a.expectLength(s),c=a.array(),h=await e.process(n,16,c);return a.writeBytes(h.subarray(0,h.length-16)),a.writeBytes(h.subarray(h.length-16)),u(),a.array()}async function bs(r,e,t){let n=Math.ceil(r.length/mt),i=[];for(let s=0;s<n;s++){let a=r.subarray(s*mt,(s+1)*mt),u=await ic(a,e,t);i.push(u)}return i}async function ln(r,e,t){let n=await R.importKey("raw",r,{name:"HMAC",hash:{name:`SHA-${t}`}},!1,["sign"]);var i=new Uint8Array(await R.sign("HMAC",n,e));return i}async function sc(r,e,t,n){let i=n>>3,s=Math.ceil(t/i),a=new Uint8Array(s*i),u=await R.importKey("raw",r,{name:"HMAC",hash:{name:`SHA-${n}`}},!1,["sign"]),c=new Uint8Array(0);for(let h=0;h<s;h++){let l=ae(c,e,[h+1]),f=await R.sign("HMAC",u,l),m=new Uint8Array(f);a.set(m,i*h),c=m}return a.subarray(0,t)}async function oe(r,e,t,n,i){let s=_s.encode(e),a=ae([(n&65280)>>8,n&255],[xs.length+s.length],xs,s,[t.length],t);return sc(r,a,n,i)}async function ac(r,e,t,n,i){let s=n>>>3,a=new Uint8Array(s),u=await R.importKey("raw",r,{name:"ECDH",namedCurve:"P-256"},!1,[]),c=await R.deriveBits({name:"ECDH",public:u},e,256),h=new Uint8Array(c),l=await R.digest("SHA-256",t),f=new Uint8Array(l),m=await ln(new Uint8Array(1),a,n),b=await R.digest(`SHA-${n}`,new Uint8Array(0)),_=new Uint8Array(b),L=await oe(m,"derived",_,s,n),A=await ln(L,h,n),P=await oe(A,"c hs traffic",f,s,n),I=await oe(A,"s hs traffic",f,s,n),x=await oe(P,"key",new Uint8Array(0),i,n),D=await oe(I,"key",new Uint8Array(0),i,n),W=await oe(P,"iv",new Uint8Array(0),12,n),k=await oe(I,"iv",new Uint8Array(0),12,n);return{serverHandshakeKey:D,serverHandshakeIV:k,clientHandshakeKey:x,clientHandshakeIV:W,handshakeSecret:A,clientSecret:P,serverSecret:I}}async function oc(r,e,t,n){let i=t>>>3,s=new Uint8Array(i),a=await R.digest(`SHA-${t}`,new Uint8Array(0)),u=new Uint8Array(a),c=await oe(r,"derived",u,i,t),h=await ln(c,s,t),l=await oe(h,"c ap traffic",e,i,t),f=await oe(h,"s ap traffic",e,i,t),m=await oe(l,"key",new Uint8Array(0),n,t),b=await oe(f,"key",new Uint8Array(0),n,t),_=await oe(l,"iv",new Uint8Array(0),12,t),L=await oe(f,"iv",new Uint8Array(0),12,t);return{serverApplicationKey:b,serverApplicationIV:L,clientApplicationKey:m,clientApplicationIV:_}}function $t(r){return r>64&&r<91?r-65:r>96&&r<123?r-71:r>47&&r<58?r+4:r===43?62:r===47?63:r===61?64:void 0}function uc(r){let e=r.length,t=0,n=0,i=64,s=64,a=64,u=64,c=new Uint8Array(e*.75);for(;t<e;)i=$t(r.charCodeAt(t++)),s=$t(r.charCodeAt(t++)),a=$t(r.charCodeAt(t++)),u=$t(r.charCodeAt(t++)),c[n++]=i<<2|s>>4,c[n++]=(s&15)<<4|a>>2,c[n++]=(a&3)<<6|u;let h=s===64?0:a===64?2:u===64?1:0;return c.subarray(0,n-h)}function As(r,e=(n,i)=>i,t){return JSON.stringify(r,(n,i)=>e(n,typeof i!="object"||i===null||Array.isArray(i)?i:Object.fromEntries(Object.entries(i).sort(([s],[a])=>s<a?-1:s>a?1:0))),t)}function pc(r){let{length:e}=r;if(e>4)throw new Error(`Bit string length ${e} would overflow JS bit operators`);let t=0,n=0;for(let i=r.length-1;i>=0;i--)t|=r[i]<<n,n+=8;return t}function Es(r,e){let t={};r.expectUint8(se,0);let[n,i]=r.expectASN1Length(0);for(;i()>0;){r.expectUint8(cc,0);let[s]=r.expectASN1Length(0);r.expectUint8(se,0);let[a]=r.expectASN1Length(0);r.expectUint8(Ze,0);let u=r.readASN1OID(),c=dc[u]??u,h=r.readUint8();if(h!==hc&&h!==lc)throw new Error(`Unexpected item type in certificate ${e}: 0x${Be([h])}`);let[l,f]=r.expectASN1Length(0),m=r.readUTF8String(f());if(l(),a(),s(),t[c]!==void 0)throw new Error(`Duplicate OID ${c} in certificate ${e}`);t[c]=m}return n(),t}function yc(r,e=0){let t=[],[n,i]=r.expectASN1Length(0);for(;i()>0;){let s=r.readUint8(0),[a,u]=r.expectASN1Length(0),c;s===(e|2)?c=r.readUTF8String(u()):c=r.readBytes(u()),t.push({name:c,type:s}),a()}return n(),t}function wc(r){let e={"1.2.840.113549.1.1.1":{name:"RSAES-PKCS1-v1_5"},"1.2.840.113549.1.1.5":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}},"1.2.840.113549.1.1.11":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},"1.2.840.113549.1.1.12":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}},"1.2.840.113549.1.1.13":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}},"1.2.840.113549.1.1.10":{name:"RSA-PSS"},"1.2.840.113549.1.1.7":{name:"RSA-OAEP"},"1.2.840.10045.2.1":{name:"ECDSA",hash:{name:"SHA-1"}},"1.2.840.10045.4.1":{name:"ECDSA",hash:{name:"SHA-1"}},"1.2.840.10045.4.3.2":{name:"ECDSA",hash:{name:"SHA-256"}},"1.2.840.10045.4.3.3":{name:"ECDSA",hash:{name:"SHA-384"}},"1.2.840.10045.4.3.4":{name:"ECDSA",hash:{name:"SHA-512"}},"1.3.133.16.840.63.0.2":{name:"ECDH",kdf:"SHA-1"},"1.3.132.1.11.1":{name:"ECDH",kdf:"SHA-256"},"1.3.132.1.11.2":{name:"ECDH",kdf:"SHA-384"},"1.3.132.1.11.3":{name:"ECDH",kdf:"SHA-512"},"2.16.840.1.101.3.4.1.2":{name:"AES-CBC",length:128},"2.16.840.1.101.3.4.1.22":{name:"AES-CBC",length:192},"2.16.840.1.101.3.4.1.42":{name:"AES-CBC",length:256},"2.16.840.1.101.3.4.1.6":{name:"AES-GCM",length:128},"2.16.840.1.101.3.4.1.26":{name:"AES-GCM",length:192},"2.16.840.1.101.3.4.1.46":{name:"AES-GCM",length:256},"2.16.840.1.101.3.4.1.4":{name:"AES-CFB",length:128},"2.16.840.1.101.3.4.1.24":{name:"AES-CFB",length:192},"2.16.840.1.101.3.4.1.44":{name:"AES-CFB",length:256},"2.16.840.1.101.3.4.1.5":{name:"AES-KW",length:128},"2.16.840.1.101.3.4.1.25":{name:"AES-KW",length:192},"2.16.840.1.101.3.4.1.45":{name:"AES-KW",length:256},"1.2.840.113549.2.7":{name:"HMAC",hash:{name:"SHA-1"}},"1.2.840.113549.2.9":{name:"HMAC",hash:{name:"SHA-256"}},"1.2.840.113549.2.10":{name:"HMAC",hash:{name:"SHA-384"}},"1.2.840.113549.2.11":{name:"HMAC",hash:{name:"SHA-512"}},"1.2.840.113549.1.9.16.3.5":{name:"DH"},"1.3.14.3.2.26":{name:"SHA-1"},"2.16.840.1.101.3.4.2.1":{name:"SHA-256"},"2.16.840.1.101.3.4.2.2":{name:"SHA-384"},"2.16.840.1.101.3.4.2.3":{name:"SHA-512"},"1.2.840.113549.1.5.12":{name:"PBKDF2"},"1.2.840.10045.3.1.7":{name:"P-256"},"1.3.132.0.34":{name:"P-384"},"1.3.132.0.35":{name:"P-521"}}[r];if(e===void 0)throw new Error(`Unsupported algorithm identifier: ${r}`);return e}function Us(r,e=[]){return Object.values(r).forEach(t=>{typeof t=="string"?e=[...e,t]:e=Us(t,e)}),e}function mc(r){return Us(r).join(" / ")}async function Cs(r,e,t,n,i){r.expectUint8(se,0);let[s]=r.expectASN1Length(0);r.expectUint8(Vt,0);let[a,u]=r.expectASN1Length(0),c=r.readBytes(u());a(),r.expectUint8(Vt,0);let[h,l]=r.expectASN1Length(0),f=r.readBytes(l());h(),s();let m=o((A,P)=>A.length>P?A.subarray(A.length-P):A.length<P?ae(new Uint8Array(P-A.length),A):A,"m"),b=n==="P-256"?32:48,_=ae(m(c,b),m(f,b)),L=await R.importKey("spki",e,{name:"ECDSA",namedCurve:n},!1,["verify"]);if(await R.verify({name:"ECDSA",hash:i},L,_,t)!==!0)throw new Error("ECDSA-SECP256R1-SHA256 certificate verify failed")}async function Sc(r,e,t,n=!0,i=!0){for(let u of e);let s=e[0];if(s.subjectAltNameMatchingHost(r)===void 0)throw new Error(`No matching subjectAltName for ${r}`);if(!s.isValidAtMoment())throw new Error("End-user certificate is not valid now");if(n&&!s.extKeyUsage?.serverTls)throw new Error("End-user certificate has no TLS server extKeyUsage");let a=!1;for(let u of t);for(let u=0,c=e.length;u<c;u++){let h=e[u],l=h.authorityKeyIdentifier,f;if(l===void 0?f=t.find(_=>gt.distinguishedNamesAreEqual(_.subject,h.issuer)):f=t.find(_=>_.subjectKeyIdentifier!==void 0&&St(_.subjectKeyIdentifier,l)),f===void 0&&(f=e[u+1]),f===void 0)throw new Error("Ran out of certificates before reaching trusted root");let m=f instanceof fn;if(f.isValidAtMoment()!==!0)throw new Error("Signing certificate is not valid now");if(i&&f.keyUsage?.usages.has("digitalSignature")!==!0)throw new Error("Signing certificate keyUsage does not include digital signatures");if(f.basicConstraints?.ca!==!0)throw new Error("Signing certificate basicConstraints do not indicate a CA certificate");let{pathLength:b}=f.basicConstraints;if(b!==void 0&&b<u)throw new Error("Exceeded certificate pathLength");if(h.algorithm==="1.2.840.10045.4.3.2"||h.algorithm==="1.2.840.10045.4.3.3"){let _=h.algorithm==="1.2.840.10045.4.3.2"?"SHA-256":"SHA-384",L=f.publicKey.identifiers,A=L.includes("1.2.840.10045.3.1.7")?"P-256":L.includes("1.3.132.0.34")?"P-384":void 0;if(A===void 0)throw new Error("Unsupported signing key curve");let P=new Wt(h.signature);await Cs(P,f.publicKey.all,h.signedData,A,_)}else if(h.algorithm==="1.2.840.113549.1.1.11"||h.algorithm==="1.2.840.113549.1.1.12"){let _=h.algorithm==="1.2.840.113549.1.1.11"?"SHA-256":"SHA-384",L=await R.importKey("spki",f.publicKey.all,{name:"RSASSA-PKCS1-v1_5",hash:_},!1,["verify"]);if(await R.verify({name:"RSASSA-PKCS1-v1_5"},L,h.signature,h.signedData)!==!0)throw new Error("RSASSA_PKCS1-v1_5-SHA256 certificate verify failed")}else throw new Error("Unsupported signing algorithm");if(m){a=!0;break}}return a}async function xc(r,e,t,n,i,s=!0,a=!0){let u=new Wt(await e());u.expectUint8(8,0);let[c]=u.expectLengthUint24(),[h,l]=u.expectLengthUint16(0);for(;l()>0;){let z=u.readUint16(0);if(z===0)u.expectUint16(0,0);else if(z===10){let[be,_e]=u.expectLengthUint16("groups data");u.skip(_e(),0),be()}else throw new Error(`Unsupported server encrypted extension type 0x${Be([z]).padStart(4,"0")}`)}h(),c(),u.remaining()===0&&u.extend(await e());let f=!1,m=u.readUint8();if(m===13){f=!0;let[z]=u.expectLengthUint24("certificate request data");u.expectUint8(0,0);let[be,_e]=u.expectLengthUint16("certificate request extensions");u.skip(_e(),0),be(),z(),u.remaining()===0&&u.extend(await e()),m=u.readUint8()}if(m!==11)throw new Error(`Unexpected handshake message type 0x${Be([m])}`);let[b]=u.expectLengthUint24(0);u.expectUint8(0,0);let[_,L]=u.expectLengthUint24(0),A=[];for(;L()>0;){let[z]=u.expectLengthUint24(0),be=new gt(u);A.push(be),z();let[_e,Ne]=u.expectLengthUint16(),_n=u.subarray(Ne());_e()}if(_(),b(),A.length===0)throw new Error("No certificates supplied");let P=A[0],I=u.data.subarray(0,u.offset),x=ae(n,I),D=await R.digest("SHA-256",x),W=new Uint8Array(D),k=ae(bc.encode(" ".repeat(64)+"TLS 1.3, server CertificateVerify"),[0],W);u.remaining()===0&&u.extend(await e()),u.expectUint8(15,0);let[J]=u.expectLengthUint24(0),N=u.readUint16();if(N===1027){let[z]=u.expectLengthUint16();await Cs(u,P.publicKey.all,k,"P-256","SHA-256"),z()}else if(N===2052){let[z,be]=u.expectLengthUint16(),_e=u.subarray(be());z();let Ne=await R.importKey("spki",P.publicKey.all,{name:"RSA-PSS",hash:"SHA-256"},!1,["verify"]);if(await R.verify({name:"RSA-PSS",saltLength:32},Ne,_e,k)!==!0)throw new Error("RSA-PSS-RSAE-SHA256 certificate verify failed")}else throw new Error(`Unsupported certificate verify signature type 0x${Be([N]).padStart(4,"0")}`);J();let ye=u.data.subarray(0,u.offset),B=ae(n,ye),F=await oe(t,"finished",new Uint8Array(0),32,256),q=await R.digest("SHA-256",B),j=await R.importKey("raw",F,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),V=await R.sign("HMAC",j,q),G=new Uint8Array(V);u.remaining()===0&&u.extend(await e()),u.expectUint8(20,0);let[O,ue]=u.expectLengthUint24(0),re=u.readBytes(ue());if(O(),u.remaining()!==0)throw new Error("Unexpected extra bytes in server handshake");if(St(re,G)!==!0)throw new Error("Invalid server verify hash");if(!await Sc(r,A,i,s,a))throw new Error("Validated certificate chain did not end in a trusted root");return[u.data,f]}async function Is(r,e,t,n,{useSNI:i,requireServerTlsExtKeyUsage:s,requireDigitalSigKeyUsage:a,writePreData:u,expectPreData:c,commentPreData:h}={}){i??(i=!0),s??(s=!0),a??(a=!0);let l=await R.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"]),f=await R.exportKey("raw",l.publicKey),m=new Uint8Array(32);S.getRandomValues(m);let b=tc(r,f,m,i).array(),_=u?ae(u,b):b;if(n(_),c){let te=await t(c.length);if(!te||!St(te,c))throw new Error("Pre data did not match expectation")}let L=await cn(t,22);if(L===void 0)throw new Error("Connection closed while awaiting server hello");let A=new Ee(L.content),P=rc(A,m),I=await cn(t,20);if(I===void 0)throw new Error("Connection closed awaiting server cipher change");let x=new Ee(I.content),[D]=x.expectLength(1);x.expectUint8(1,0),D();let W=b.subarray(5),k=L.content,J=ae(W,k),N=await ac(P,l.privateKey,J,256,16),ye=await R.importKey("raw",N.serverHandshakeKey,{name:"AES-GCM"},!1,["decrypt"]),B=new Kt("decrypt",ye,N.serverHandshakeIV),F=await R.importKey("raw",N.clientHandshakeKey,{name:"AES-GCM"},!1,["encrypt"]),q=new Kt("encrypt",F,N.clientHandshakeIV),j=o(async()=>{let te=await hn(t,B,22);if(te===void 0)throw new Error("Premature end of encrypted server handshake");return te},"C"),[V,G]=await xc(r,j,N.serverSecret,J,e,s,a),O=new Ee(6);O.writeUint8(20,0),O.writeUint16(771,0);let ue=O.writeLengthUint16();O.writeUint8(1,0),ue();let re=O.array(),z=new Uint8Array(0);if(G){let te=new Ee(8);te.writeUint8(11,0);let rt=te.writeLengthUint24("client certificate data");te.writeUint8(0,0),te.writeUint24(0,0),rt(),z=te.array()}let be=ae(J,V,z),_e=await R.digest("SHA-256",be),Ne=new Uint8Array(_e),_n=await oe(N.clientSecret,"finished",new Uint8Array(0),32,256),da=await R.importKey("raw",_n,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),pa=await R.sign("HMAC",da,Ne),ya=new Uint8Array(pa),vt=new Ee(36);vt.writeUint8(20,0);let wa=vt.writeLengthUint24(0);vt.writeBytes(ya),wa();let ma=vt.array(),Un=await bs(ae(z,ma),q,22),Cn=Ne;if(z.length>0){let te=be.subarray(0,be.length-z.length),rt=await R.digest("SHA-256",te);Cn=new Uint8Array(rt)}let Et=await oc(N.handshakeSecret,Cn,256,16),ga=await R.importKey("raw",Et.clientApplicationKey,{name:"AES-GCM"},!0,["encrypt"]),Sa=new Kt("encrypt",ga,Et.clientApplicationIV),ba=await R.importKey("raw",Et.serverApplicationKey,{name:"AES-GCM"},!0,["decrypt"]),xa=new Kt("decrypt",ba,Et.serverApplicationIV),_t=!1;return[()=>{if(!_t){let te=ae(re,...Un);n(te),_t=!0}return hn(t,xa)},async te=>{let rt=_t;_t=!0;let In=await bs(te,Sa,23),Aa=rt?ae(...In):ae(re,...Un,...In);n(Aa)}]}var un,Ss,ec,Ee,Pf,mt,nc,R,_s,xs,Kt,Wt,sn,Vt,se,cc,Ze,hc,lc,vs,an,Me,on,fc,Je,dc,gc,gt,fn,bc,Ac,Ls,Ts=ne(()=>{p();o(ae,"p");o(St,"O");un="\xB7\xB7 ",Ss=new TextEncoder,ec=new TextDecoder,Ee=o(class{constructor(r){g(this,"offset");g(this,"dataView");g(this,"data");g(this,"comments");g(this,"indents");g(this,"indent");this.offset=0,this.data=typeof r=="number"?new Uint8Array(r):r,this.dataView=new DataView(this.data.buffer,this.data.byteOffset,this.data.byteLength),this.comments={},this.indents={},this.indent=0}extend(r){let e=typeof r=="number"?new Uint8Array(r):r;this.data=ae(this.data,e),this.dataView=new DataView(this.data.buffer,this.data.byteOffset,this.data.byteLength)}remaining(){return this.data.length-this.offset}subarray(r){return this.data.subarray(this.offset,this.offset+=r)}skip(r,e){return this.offset+=r,e&&this.comment(e),this}comment(r,e=this.offset){throw new Error("No comments should be emitted outside of chatty mode")}readBytes(r){return this.data.slice(this.offset,this.offset+=r)}readUTF8String(r){let e=this.subarray(r);return ec.decode(e)}readUTF8StringNullTerminated(){let r=this.offset;for(;this.data[r]!==0;)r++;let e=this.readUTF8String(r-this.offset);return this.expectUint8(0,"end of string"),e}readUint8(r){let e=this.dataView.getUint8(this.offset);return this.offset+=1,e}readUint16(r){let e=this.dataView.getUint16(this.offset);return this.offset+=2,e}readUint24(r){let e=this.readUint8(),t=this.readUint16();return(e<<16)+t}readUint32(r){let e=this.dataView.getUint32(this.offset);return this.offset+=4,e}expectBytes(r,e){let t=this.readBytes(r.length);if(!St(t,r))throw new Error("Unexpected bytes")}expectUint8(r,e){let t=this.readUint8();if(t!==r)throw new Error(`Expected ${r}, got ${t}`)}expectUint16(r,e){let t=this.readUint16();if(t!==r)throw new Error(`Expected ${r}, got ${t}`)}expectUint24(r,e){let t=this.readUint24();if(t!==r)throw new Error(`Expected ${r}, got ${t}`)}expectUint32(r,e){let t=this.readUint32();if(t!==r)throw new Error(`Expected ${r}, got ${t}`)}expectLength(r,e=1){let t=this.offset,n=t+r;if(n>this.data.length)throw new Error("Expected length exceeds remaining data length");return this.indent+=e,this.indents[t]=this.indent,[()=>{if(this.indent-=e,this.indents[this.offset]=this.indent,this.offset!==n)throw new Error(`${r} bytes expected but ${this.offset-t} read`)},()=>n-this.offset]}expectLengthUint8(r){let e=this.readUint8();return this.expectLength(e)}expectLengthUint16(r){let e=this.readUint16();return this.expectLength(e)}expectLengthUint24(r){let e=this.readUint24();return this.expectLength(e)}expectLengthUint32(r){let e=this.readUint32();return this.expectLength(e)}expectLengthUint8Incl(r){let e=this.readUint8();return this.expectLength(e-1)}expectLengthUint16Incl(r){let e=this.readUint16();return this.expectLength(e-2)}expectLengthUint24Incl(r){let e=this.readUint24();return this.expectLength(e-3)}expectLengthUint32Incl(r){let e=this.readUint32();return this.expectLength(e-4)}writeBytes(r){return this.data.set(r,this.offset),this.offset+=r.length,this}writeUTF8String(r){let e=Ss.encode(r);return this.writeBytes(e),this}writeUTF8StringNullTerminated(r){let e=Ss.encode(r);return this.writeBytes(e),this.writeUint8(0),this}writeUint8(r,e){return this.dataView.setUint8(this.offset,r),this.offset+=1,this}writeUint16(r,e){return this.dataView.setUint16(this.offset,r),this.offset+=2,this}writeUint24(r,e){return this.writeUint8((r&16711680)>>16),this.writeUint16(r&65535,e),this}writeUint32(r,e){return this.dataView.setUint32(this.offset,r),this.offset+=4,this}_writeLengthGeneric(r,e,t){let n=this.offset;this.offset+=r;let i=this.offset;return this.indent+=1,this.indents[i]=this.indent,()=>{let s=this.offset-(e?n:i);if(r===1)this.dataView.setUint8(n,s);else if(r===2)this.dataView.setUint16(n,s);else if(r===3)this.dataView.setUint8(n,(s&16711680)>>16),this.dataView.setUint16(n+1,s&65535);else if(r===4)this.dataView.setUint32(n,s);else throw new Error(`Invalid length for length field: ${r}`);this.indent-=1,this.indents[this.offset]=this.indent}}writeLengthUint8(r){return this._writeLengthGeneric(1,!1,r)}writeLengthUint16(r){return this._writeLengthGeneric(2,!1,r)}writeLengthUint24(r){return this._writeLengthGeneric(3,!1,r)}writeLengthUint32(r){return this._writeLengthGeneric(4,!1,r)}writeLengthUint8Incl(r){return this._writeLengthGeneric(1,!0,r)}writeLengthUint16Incl(r){return this._writeLengthGeneric(2,!0,r)}writeLengthUint24Incl(r){return this._writeLengthGeneric(3,!0,r)}writeLengthUint32Incl(r){return this._writeLengthGeneric(4,!0,r)}array(){return this.data.subarray(0,this.offset)}commentedString(r=!1){let e=this.indents[0]!==void 0?un.repeat(this.indents[0]):"",t=this.indents[0]??0,n=r?this.data.length:this.offset;for(let i=0;i<n;i++){e+=this.data[i].toString(16).padStart(2,"0")+" ";let s=this.comments[i+1];this.indents[i+1]!==void 0&&(t=this.indents[i+1]),s&&(e+=` ${s}
${un.repeat(t)}`)}return e}},"N");o(tc,"St");o(Be,"K");o(rc,"Ut");Pf=new RegExp(`  .+|^(${un})+`,"gm"),mt=1<<14,nc=mt+1+255;o(cn,"ht");o(hn,"dt");o(ic,"ee");o(bs,"At");R=S.subtle,_s=new TextEncoder;o(ln,"lt");o(sc,"ne");xs=_s.encode("tls13 ");o(oe,"S");o(ac,"Kt");o(oc,"Tt");Kt=o(class{constructor(r,e,t){g(this,"recordsProcessed",0n);g(this,"priorPromise",Promise.resolve(new Uint8Array));this.mode=r,this.key=e,this.initialIv=t}async process(r,e,t){let n=this.processUnsequenced(r,e,t);return this.priorPromise=this.priorPromise.then(()=>n)}async processUnsequenced(r,e,t){let n=this.recordsProcessed;this.recordsProcessed+=1n;let i=this.initialIv.slice(),s=BigInt(i.length),a=s-1n;for(let l=0n;l<s;l++){let f=n>>(l<<3n);if(f===0n)break;i[Number(a-l)]^=Number(f&0xffn)}let u=e<<3,c={name:"AES-GCM",iv:i,tagLength:u,additionalData:t},h=await R[this.mode](c,this.key,r);return new Uint8Array(h)}},"Q");o($t,"yt");o(uc,"Dt");Wt=o(class extends Ee{readASN1Length(r){let e=this.readUint8();if(e<128)return e;let t=e&127,n=0;if(t===1)return this.readUint8(n);if(t===2)return this.readUint16(n);if(t===3)return this.readUint24(n);if(t===4)return this.readUint32(n);throw new Error(`ASN.1 length fields are only supported up to 4 bytes (this one is ${t} bytes)`)}expectASN1Length(r){let e=this.readASN1Length(r);return this.expectLength(e)}readASN1OID(){let[r,e]=this.expectASN1Length(0),t=this.readUint8(),n=`${Math.floor(t/40)}.${t%40}`;for(;e()>0;){let i=0;for(;;){let s=this.readUint8();if(i<<=7,i+=s&127,s<128)break}n+=`.${i}`}return r(),n}readASN1Boolean(){let[r,e]=this.expectASN1Length(0),t=e();if(t!==1)throw new Error(`Boolean has weird length: ${t}`);let n=this.readUint8(),i;if(n===255)i=!0;else if(n===0)i=!1;else throw new Error(`Boolean has weird value: 0x${Be([n])}`);return r(),i}readASN1UTCTime(){let[r,e]=this.expectASN1Length(0),t=this.readUTF8String(e()).match(/^(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z$/);if(!t)throw new Error("Unrecognised ASN.1 UTC time format");let[,n,i,s,a,u,c]=t,h=parseInt(n,10),l=h+(h>=50?1900:2e3),f=new Date(`${l}-${i}-${s}T${a}:${u}:${c}Z`);return r(),f}readASN1BitString(){let[r,e]=this.expectASN1Length(0),t=this.readUint8(0),n=e(),i=this.readBytes(n);if(t>7)throw new Error(`Invalid right pad value: ${t}`);if(t>0){let s=8-t;for(let a=n-1;a>0;a--)i[a]=255&i[a-1]<<s|i[a]>>>t;i[0]=i[0]>>>t}return r(),i}},"_");o(As,"mt");sn=1,Vt=2,se=48,cc=49,Ze=6,hc=19,lc=12,vs=23,an=5,Me=4,on=3,fc=163,Je=128,dc={"2.5.4.6":"C","2.5.4.10":"O","2.5.4.11":"OU","2.5.4.3":"CN","2.5.4.7":"L","2.5.4.8":"ST","2.5.4.12":"T","2.5.4.42":"GN","2.5.4.43":"I","2.5.4.4":"SN","1.2.840.113549.1.9.1":"E-mail"};o(pc,"qt");o(Es,"Ct");o(yc,"Bt");o(wc,"Ft");o(Us,"Ot");o(mc,"Pt");gc=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],gt=o(class{constructor(r){g(this,"serialNumber");g(this,"algorithm");g(this,"issuer");g(this,"validityPeriod");g(this,"subject");g(this,"publicKey");g(this,"signature");g(this,"keyUsage");g(this,"subjectAltNames");g(this,"extKeyUsage");g(this,"authorityKeyIdentifier");g(this,"subjectKeyIdentifier");g(this,"basicConstraints");g(this,"signedData");let e=r instanceof Wt?r:new Wt(r);e.expectUint8(se,0);let[t]=e.expectASN1Length(0),n=e.offset;e.expectUint8(se,0);let[i]=e.expectASN1Length(0);e.expectBytes([160,3,2,1,2],0),e.expectUint8(Vt,0);let[s,a]=e.expectASN1Length(0);this.serialNumber=e.subarray(a()),s(),e.expectUint8(se,0);let[u,c]=e.expectASN1Length(0);e.expectUint8(Ze,0),this.algorithm=e.readASN1OID(),c()>0&&(e.expectUint8(an,0),e.expectUint8(0,0)),u(),this.issuer=Es(e,"issuer"),e.expectUint8(se,0);let[h]=e.expectASN1Length(0);e.expectUint8(vs,0);let l=e.readASN1UTCTime();e.expectUint8(vs,0);let f=e.readASN1UTCTime();this.validityPeriod={notBefore:l,notAfter:f},h(),this.subject=Es(e,"subject");let m=e.offset;e.expectUint8(se,0);let[b]=e.expectASN1Length(0);e.expectUint8(se,0);let[_,L]=e.expectASN1Length(0),A=[];for(;L()>0;){let N=e.readUint8();if(N===Ze){let ye=e.readASN1OID();A.push(ye)}else N===an&&e.expectUint8(0,0)}_(),e.expectUint8(on,0);let P=e.readASN1BitString();this.publicKey={identifiers:A,data:P,all:e.data.subarray(m,e.offset)},b(),e.expectUint8(fc,0);let[I]=e.expectASN1Length();e.expectUint8(se,0);let[x,D]=e.expectASN1Length(0);for(;D()>0;){e.expectUint8(se,0);let[N,ye]=e.expectASN1Length();e.expectUint8(Ze,0);let B=e.readASN1OID();if(B==="2.5.29.17"){e.expectUint8(Me,0);let[F]=e.expectASN1Length(0);e.expectUint8(se,0);let q=yc(e,Je);this.subjectAltNames=q.filter(j=>j.type===(2|Je)).map(j=>j.name),F()}else if(B==="2.5.29.15"){e.expectUint8(sn,0);let F=e.readASN1Boolean();e.expectUint8(Me,0);let[q]=e.expectASN1Length(0);e.expectUint8(on,0);let j=e.readASN1BitString(),V=pc(j),G=new Set(gc.filter((O,ue)=>V&1<<ue));q(),this.keyUsage={critical:F,usages:G}}else if(B==="2.5.29.37"){this.extKeyUsage={},e.expectUint8(Me,0);let[F]=e.expectASN1Length(0);e.expectUint8(se,0);let[q,j]=e.expectASN1Length(0);for(;j()>0;){e.expectUint8(Ze,0);let V=e.readASN1OID();V==="1.3.6.1.5.5.7.3.1"&&(this.extKeyUsage.serverTls=!0),V==="1.3.6.1.5.5.7.3.2"&&(this.extKeyUsage.clientTls=!0)}q(),F()}else if(B==="2.5.29.35"){e.expectUint8(Me,0);let[F]=e.expectASN1Length(0);e.expectUint8(se,0);let[q,j]=e.expectASN1Length(0);for(;j()>0;){let V=e.readUint8();if(V===(Je|0)){let[G,O]=e.expectASN1Length(0);this.authorityKeyIdentifier=e.readBytes(O()),G()}else if(V===(Je|1)){let[G,O]=e.expectASN1Length(0);e.skip(O(),0),G()}else if(V===(Je|2)){let[G,O]=e.expectASN1Length(0);e.skip(O(),0),G()}else if(V===(Je|33)){let[G,O]=e.expectASN1Length(0);e.skip(O(),0),G()}else throw new Error(`Unexpected data type ${V} in authorityKeyIdentifier certificate extension`)}q(),F()}else if(B==="2.5.29.14"){e.expectUint8(Me,0);let[F]=e.expectASN1Length(0);e.expectUint8(Me,0);let[q,j]=e.expectASN1Length(0);this.subjectKeyIdentifier=e.readBytes(j()),q(),F()}else if(B==="2.5.29.19"){let F,q=e.readUint8();if(q===sn&&(F=e.readASN1Boolean(),q=e.readUint8()),q!==Me)throw new Error("Unexpected type in certificate basic constraints");let[j]=e.expectASN1Length(0);e.expectUint8(se,0);let[V,G]=e.expectASN1Length(),O;G()>0&&(e.expectUint8(sn,0),O=e.readASN1Boolean());let ue;if(G()>0){e.expectUint8(Vt,0);let re=e.readASN1Length(0);if(ue=re===1?e.readUint8():re===2?e.readUint16():re===3?e.readUint24():void 0,ue===void 0)throw new Error("Too many bytes in max path length in certificate basicConstraints")}V(),j(),this.basicConstraints={critical:F,ca:O,pathLength:ue}}else e.skip(ye(),0);N()}x(),I(),i(),this.signedData=e.data.subarray(n,e.offset),e.expectUint8(se,0);let[W,k]=e.expectASN1Length(0);e.expectUint8(Ze,0);let J=e.readASN1OID();if(k()>0&&(e.expectUint8(an,0),e.expectUint8(0,0)),W(),J!==this.algorithm)throw new Error(`Certificate specifies different signature algorithms inside (${this.algorithm}) and out (${J})`);e.expectUint8(on,0),this.signature=e.readASN1BitString(),t()}static distinguishedNamesAreEqual(r,e){return As(r)===As(e)}static readableDN(r){return Object.entries(r).map(e=>e.join("=")).join(", ")}static fromPEM(r){let e="[A-Z0-9 ]+",t=new RegExp(`-{5}BEGIN ${e}-{5}([a-zA-Z0-9=+\\/\\n\\r]+)-{5}END ${e}-{5}`,"g"),n=[],i=null;for(;i=t.exec(r);){let s=i[1].replace(/[\r\n]/g,""),a=uc(s),u=new this(a);n.push(u)}return n}subjectAltNameMatchingHost(r){let e=/[.][^.]+[.][^.]+$/;return(this.subjectAltNames??[]).find(t=>{let n=t,i=r;if(e.test(r)&&e.test(n)&&n.startsWith("*.")&&(n=n.slice(1),i=i.slice(i.indexOf("."))),n===i)return!0})}isValidAtMoment(r=new Date){return r>=this.validityPeriod.notBefore&&r<=this.validityPeriod.notAfter}description(){return"subject: "+gt.readableDN(this.subject)+(this.subjectAltNames?`
subject alt names: `+this.subjectAltNames.join(", "):"")+(this.subjectKeyIdentifier?`
subject key id: ${Be(this.subjectKeyIdentifier," ")}`:"")+`
issuer: `+gt.readableDN(this.issuer)+(this.authorityKeyIdentifier?`
authority key id: ${Be(this.authorityKeyIdentifier," ")}`:"")+`
validity: `+this.validityPeriod.notBefore.toISOString()+" \u2013 "+this.validityPeriod.notAfter.toISOString()+` (${this.isValidAtMoment()?"currently valid":"not valid"})`+(this.keyUsage?`
key usage (${this.keyUsage.critical?"critical":"non-critical"}): `+[...this.keyUsage.usages].join(", "):"")+(this.extKeyUsage?`
extended key usage: TLS server \u2014\xA0${this.extKeyUsage.serverTls}, TLS client \u2014\xA0${this.extKeyUsage.clientTls}`:"")+(this.basicConstraints?`
basic constraints (${this.basicConstraints.critical?"critical":"non-critical"}): CA \u2014\xA0${this.basicConstraints.ca}, path length \u2014 ${this.basicConstraints.pathLength}`:"")+`
signature algorithm: `+mc(wc(this.algorithm))}toJSON(){return{serialNumber:[...this.serialNumber],algorithm:this.algorithm,issuer:this.issuer,validityPeriod:{notBefore:this.validityPeriod.notBefore.toISOString(),notAfter:this.validityPeriod.notAfter.toISOString()},subject:this.subject,publicKey:{identifiers:this.publicKey.identifiers,data:[...this.publicKey.data],all:[...this.publicKey.all]},signature:[...this.signature],keyUsage:{critical:this.keyUsage?.critical,usages:[...this.keyUsage?.usages??[]]},subjectAltNames:this.subjectAltNames,extKeyUsage:this.extKeyUsage,authorityKeyIdentifier:this.authorityKeyIdentifier&&[...this.authorityKeyIdentifier],subjectKeyIdentifier:this.subjectKeyIdentifier&&[...this.subjectKeyIdentifier],basicConstraints:this.basicConstraints,signedData:[...this.signedData]}}},"P"),fn=o(class extends gt{},"st");o(Cs,"pt");o(Sc,"jt");bc=new TextEncoder;o(xc,"Vt");o(Is,"he");Ac=o(class{constructor(){g(this,"queue");g(this,"outstandingRequest");this.queue=[]}enqueue(r){this.queue.push(r),this.dequeue()}dequeue(){if(this.outstandingRequest===void 0)return;let{resolve:r,bytes:e}=this.outstandingRequest,t=this.bytesInQueue();if(t<e&&this.socketIsNotClosed())return;if(e=Math.min(e,t),e===0)return r(void 0);this.outstandingRequest=void 0;let n=this.queue[0],i=n.length;if(i===e)return this.queue.shift(),r(n);if(i>e)return this.queue[0]=n.subarray(e),r(n.subarray(0,e));{let s=new Uint8Array(e),a=e,u=0;for(;a>0;){let c=this.queue[0],h=c.length;h<=a?(this.queue.shift(),s.set(c,u),u+=h,a-=h):(this.queue[0]=c.subarray(a),s.set(c.subarray(0,a),u),a-=a,u+=a)}return r(s)}}bytesInQueue(){return this.queue.reduce((r,e)=>r+e.length,0)}async read(r){if(this.outstandingRequest!==void 0)throw new Error("Can\u2019t read while already awaiting read");return new Promise(e=>{this.outstandingRequest={resolve:e,bytes:r},this.dequeue()})}},"xt"),Ls=o(class extends Ac{constructor(r){super(),this.socket=r,r.addEventListener("message",e=>this.enqueue(new Uint8Array(e.data))),r.addEventListener("close",()=>this.dequeue())}socketIsNotClosed(){let{socket:r}=this,{readyState:e}=r;return e<=1}},"vt")});var dn,Bs=ne(()=>{dn=`-----BEGIN CERTIFICATE-----
MIIFazCCA1OgAwIBAgIRAIIQz7DSQONZRGPgu2OCiwAwDQYJKoZIhvcNAQELBQAw
TzELMAkGA1UEBhMCVVMxKTAnBgNVBAoTIEludGVybmV0IFNlY3VyaXR5IFJlc2Vh
cmNoIEdyb3VwMRUwEwYDVQQDEwxJU1JHIFJvb3QgWDEwHhcNMTUwNjA0MTEwNDM4
WhcNMzUwNjA0MTEwNDM4WjBPMQswCQYDVQQGEwJVUzEpMCcGA1UEChMgSW50ZXJu
ZXQgU2VjdXJpdHkgUmVzZWFyY2ggR3JvdXAxFTATBgNVBAMTDElTUkcgUm9vdCBY
MTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAK3oJHP0FDfzm54rVygc
h77ct984kIxuPOZXoHj3dcKi/vVqbvYATyjb3miGbESTtrFj/RQSa78f0uoxmyF+
0TM8ukj13Xnfs7j/EvEhmkvBioZxaUpmZmyPfjxwv60pIgbz5MDmgK7iS4+3mX6U
A5/TR5d8mUgjU+g4rk8Kb4Mu0UlXjIB0ttov0DiNewNwIRt18jA8+o+u3dpjq+sW
T8KOEUt+zwvo/7V3LvSye0rgTBIlDHCNAymg4VMk7BPZ7hm/ELNKjD+Jo2FR3qyH
B5T0Y3HsLuJvW5iB4YlcNHlsdu87kGJ55tukmi8mxdAQ4Q7e2RCOFvu396j3x+UC
B5iPNgiV5+I3lg02dZ77DnKxHZu8A/lJBdiB3QW0KtZB6awBdpUKD9jf1b0SHzUv
KBds0pjBqAlkd25HN7rOrFleaJ1/ctaJxQZBKT5ZPt0m9STJEadao0xAH0ahmbWn
OlFuhjuefXKnEgV4We0+UXgVCwOPjdAvBbI+e0ocS3MFEvzG6uBQE3xDk3SzynTn
jh8BCNAw1FtxNrQHusEwMFxIt4I7mKZ9YIqioymCzLq9gwQbooMDQaHWBfEbwrbw
qHyGO0aoSCqI3Haadr8faqU9GY/rOPNk3sgrDQoo//fb4hVC1CLQJ13hef4Y53CI
rU7m2Ys6xt0nUW7/vGT1M0NPAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNV
HRMBAf8EBTADAQH/MB0GA1UdDgQWBBR5tFnme7bl5AFzgAiIyBpY9umbbjANBgkq
hkiG9w0BAQsFAAOCAgEAVR9YqbyyqFDQDLHYGmkgJykIrGF1XIpu+ILlaS/V9lZL
ubhzEFnTIZd+50xx+7LSYK05qAvqFyFWhfFQDlnrzuBZ6brJFe+GnY+EgPbk6ZGQ
3BebYhtF8GaV0nxvwuo77x/Py9auJ/GpsMiu/X1+mvoiBOv/2X/qkSsisRcOj/KK
NFtY2PwByVS5uCbMiogziUwthDyC3+6WVwW6LLv3xLfHTjuCvjHIInNzktHCgKQ5
ORAzI4JMPJ+GslWYHb4phowim57iaztXOoJwTdwJx4nLCgdNbOhdjsnvzqvHu7Ur
TkXWStAmzOVyyghqpZXjFaH3pO3JLF+l+/+sKAIuvtd7u+Nxe5AW0wdeRlN8NwdC
jNPElpzVmbUq4JUagEiuTDkHzsxHpFKVK7q4+63SM1N95R1NbdWhscdCb+ZAJzVc
oyi3B43njTOQ5yOf+1CceWxG1bQVs5ZufpsMljq4Ui0/1lvh+wjChP4kqKOJ2qxq
4RgqsahDYVvTH9w7jXbyLeiNdd8XM2w9U/t7y0Ff/9yi0GE44Za4rF2LN9d11TPA
mRGunUHBcnWEvgJBQl9nJEiU0Zsnvgc/ubhPgXRR4Xq37Z0j4r7g1SgEEzwxA57d
emyPxgcYxn/eR44/KJ4EBs+lVDR3veyJm+kXQ99b21/+jh5Xos1AnX5iItreGCc=
-----END CERTIFICATE-----
`});var Rs={};we(Rs,{Socket:()=>X,isIP:()=>Ec});function Ec(r){return 0}var Ps,K,X,pn=ne(()=>{"use strict";p();Ps=nt(Le(),1);Ts();Bs();o(Ec,"isIP");K=class extends Ps.EventEmitter{constructor(){super(...arguments);g(this,"_poolQueryViaFetch");g(this,"_webSocketConstructor");g(this,"_wsProxy");g(this,"_coalesceWrites");g(this,"_useSecureWebSocket");g(this,"_forceDisablePgSSL");g(this,"_disableSNI");g(this,"_pipelineConnect");g(this,"_pipelineTLS");g(this,"_rootCerts");g(this,"connecting",!1);g(this,"pending",!0);g(this,"writable",!0);g(this,"encrypted",!1);g(this,"authorized",!1);g(this,"destroyed",!1);g(this,"ws",null);g(this,"writeBuffer");g(this,"tlsState",0);g(this,"tlsRead");g(this,"tlsWrite")}get poolQueryViaFetch(){return this._poolQueryViaFetch??K.poolQueryViaFetch??K.defaults.poolQueryViaFetch}set poolQueryViaFetch(t){this._poolQueryViaFetch=t}get webSocketConstructor(){return this._webSocketConstructor??K.webSocketConstructor??K.defaults.webSocketConstructor}set webSocketConstructor(t){this._webSocketConstructor=t}get wsProxy(){return this._wsProxy??K.wsProxy??K.defaults.wsProxy}set wsProxy(t){this._wsProxy=t}get coalesceWrites(){return this._coalesceWrites??K.coalesceWrites??K.defaults.coalesceWrites}set coalesceWrites(t){this._coalesceWrites=t}get useSecureWebSocket(){return this._useSecureWebSocket??K.useSecureWebSocket??K.defaults.useSecureWebSocket}set useSecureWebSocket(t){this._useSecureWebSocket=t}get forceDisablePgSSL(){return this._forceDisablePgSSL??K.forceDisablePgSSL??K.defaults.forceDisablePgSSL}set forceDisablePgSSL(t){this._forceDisablePgSSL=t}get disableSNI(){return this._disableSNI??K.disableSNI??K.defaults.disableSNI}set disableSNI(t){this._disableSNI=t}get pipelineConnect(){return this._pipelineConnect??K.pipelineConnect??K.defaults.pipelineConnect}set pipelineConnect(t){this._pipelineConnect=t}get pipelineTLS(){return this._pipelineTLS??K.pipelineTLS??K.defaults.pipelineTLS}set pipelineTLS(t){this._pipelineTLS=t}get rootCerts(){return this._rootCerts??K.rootCerts??K.defaults.rootCerts}set rootCerts(t){this._rootCerts=t}wsProxyAddrForHost(t,n){let i=this.wsProxy;if(i===void 0)throw new Error("No WebSocket proxy is configured. Please refer to https://github.com/neondatabase/serverless#run-your-own-websocket-proxy");return typeof i=="function"?i(t,n):`${i}?address=${t}:${n}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}async connect(t,n,i){this.connecting=!0,i&&this.once("connect",i);let s;try{s=this.wsProxyAddrForHost(n,typeof t=="string"?parseInt(t,10):t)}catch(a){this.emit("error",a),this.emit("close");return}return this.ws=await new Promise(async a=>{try{let c=(this.useSecureWebSocket?"wss:":"ws:")+"//"+s,h;if(this.webSocketConstructor!==void 0)h=new this.webSocketConstructor(c);else try{h=new WebSocket(c)}catch{h=new __unstable_WebSocket(c)}h.addEventListener("open",()=>{a(h)})}catch(u){try{let h=(this.useSecureWebSocket?"https:":"http:")+"//"+s;await fetch(h,{headers:{Upgrade:"websocket"}}).then(l=>{let f=l.webSocket;if(f==null)throw u;f.accept(),a(f)})}catch{this.emit("error",new Error("All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless#run-on-node")),this.emit("close");return}}}),this.ws.binaryType="arraybuffer",this.ws.addEventListener("error",a=>{this.emit("error",a),this.emit("close")}),this.ws.addEventListener("close",()=>{this.emit("close")}),this.ws.addEventListener("message",a=>{if(this.tlsState===0){let u=y.from(a.data);this.emit("data",u)}}),this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready"),this}async startTls(t){this.tlsState=1;let n=fn.fromPEM(dn),i=new Ls(this.ws),s=i.read.bind(i),a=this.rawWrite.bind(this),[u,c]=await Is(t,n,s,a,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=u,this.tlsWrite=c,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let t=await this.tlsRead();if(t===void 0)break;{let n=y.from(t);this.emit("data",n)}}}rawWrite(t){if(!this.coalesceWrites){this.ws.send(t);return}if(this.writeBuffer===void 0)this.writeBuffer=t,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let n=new Uint8Array(this.writeBuffer.length+t.length);n.set(this.writeBuffer),n.set(t,this.writeBuffer.length),this.writeBuffer=n}}write(t,n="utf8",i=s=>{}){return t.length===0?i():(typeof t=="string"&&(t=y.from(t,n)),this.tlsState===0?this.rawWrite(t):this.tlsState===1?this.once("secureConnection",()=>this.write(t,n,i)):this.tlsWrite(t),!0)}end(t=y.alloc(0),n="utf8",i){return this.write(t,n,()=>{this.ws.close(),i&&i()}),this}destroy(){return this.destroyed=!0,this.end()}},X=K;o(X,"Socket"),g(X,"defaults",{poolQueryViaFetch:!1,webSocketConstructor:void 0,wsProxy:t=>t+"/v2",useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,disableSNI:!1,pipelineConnect:"password",pipelineTLS:!1,rootCerts:dn}),g(X,"poolQueryViaFetch"),g(X,"webSocketConstructor"),g(X,"wsProxy"),g(X,"coalesceWrites"),g(X,"useSecureWebSocket"),g(X,"forceDisablePgSSL"),g(X,"disableSNI"),g(X,"pipelineConnect"),g(X,"pipelineTLS"),g(X,"rootCerts")});var yn=T(C=>{"use strict";p();Object.defineProperty(C,"__esModule",{value:!0});C.NoticeMessage=C.DataRowMessage=C.CommandCompleteMessage=C.ReadyForQueryMessage=C.NotificationResponseMessage=C.BackendKeyDataMessage=C.AuthenticationMD5Password=C.ParameterStatusMessage=C.ParameterDescriptionMessage=C.RowDescriptionMessage=C.Field=C.CopyResponse=C.CopyDataMessage=C.DatabaseError=C.copyDone=C.emptyQuery=C.replicationStart=C.portalSuspended=C.noData=C.closeComplete=C.bindComplete=C.parseComplete=void 0;C.parseComplete={name:"parseComplete",length:5};C.bindComplete={name:"bindComplete",length:5};C.closeComplete={name:"closeComplete",length:5};C.noData={name:"noData",length:5};C.portalSuspended={name:"portalSuspended",length:5};C.replicationStart={name:"replicationStart",length:4};C.emptyQuery={name:"emptyQuery",length:4};C.copyDone={name:"copyDone",length:4};var Gt=class extends Error{constructor(e,t,n){super(e),this.length=t,this.name=n}};o(Gt,"DatabaseError");C.DatabaseError=Gt;var zt=class{constructor(e,t){this.length=e,this.chunk=t,this.name="copyData"}};o(zt,"CopyDataMessage");C.CopyDataMessage=zt;var Yt=class{constructor(e,t,n,i){this.length=e,this.name=t,this.binary=n,this.columnTypes=new Array(i)}};o(Yt,"CopyResponse");C.CopyResponse=Yt;var Jt=class{constructor(e,t,n,i,s,a,u){this.name=e,this.tableID=t,this.columnID=n,this.dataTypeID=i,this.dataTypeSize=s,this.dataTypeModifier=a,this.format=u}};o(Jt,"Field");C.Field=Jt;var Zt=class{constructor(e,t){this.length=e,this.fieldCount=t,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};o(Zt,"RowDescriptionMessage");C.RowDescriptionMessage=Zt;var Xt=class{constructor(e,t){this.length=e,this.parameterCount=t,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};o(Xt,"ParameterDescriptionMessage");C.ParameterDescriptionMessage=Xt;var er=class{constructor(e,t,n){this.length=e,this.parameterName=t,this.parameterValue=n,this.name="parameterStatus"}};o(er,"ParameterStatusMessage");C.ParameterStatusMessage=er;var tr=class{constructor(e,t){this.length=e,this.salt=t,this.name="authenticationMD5Password"}};o(tr,"AuthenticationMD5Password");C.AuthenticationMD5Password=tr;var rr=class{constructor(e,t,n){this.length=e,this.processID=t,this.secretKey=n,this.name="backendKeyData"}};o(rr,"BackendKeyDataMessage");C.BackendKeyDataMessage=rr;var nr=class{constructor(e,t,n,i){this.length=e,this.processId=t,this.channel=n,this.payload=i,this.name="notification"}};o(nr,"NotificationResponseMessage");C.NotificationResponseMessage=nr;var ir=class{constructor(e,t){this.length=e,this.status=t,this.name="readyForQuery"}};o(ir,"ReadyForQueryMessage");C.ReadyForQueryMessage=ir;var sr=class{constructor(e,t){this.length=e,this.text=t,this.name="commandComplete"}};o(sr,"CommandCompleteMessage");C.CommandCompleteMessage=sr;var ar=class{constructor(e,t){this.length=e,this.fields=t,this.name="dataRow",this.fieldCount=t.length}};o(ar,"DataRowMessage");C.DataRowMessage=ar;var or=class{constructor(e,t){this.length=e,this.message=t,this.name="notice"}};o(or,"NoticeMessage");C.NoticeMessage=or});var Fs=T(cr=>{"use strict";p();Object.defineProperty(cr,"__esModule",{value:!0});cr.Writer=void 0;var ur=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=y.allocUnsafe(e)}ensure(e){var t=this.buffer.length-this.offset;if(t<e){var n=this.buffer,i=n.length+(n.length>>1)+e;this.buffer=y.allocUnsafe(i),n.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{var t=y.byteLength(e);this.ensure(t+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=t}return this.buffer[this.offset++]=0,this}addString(e=""){var t=y.byteLength(e);return this.ensure(t),this.buffer.write(e,this.offset),this.offset+=t,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let t=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(t,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){var t=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=y.allocUnsafe(this.size),t}};o(ur,"Writer");cr.Writer=ur});var ks=T(lr=>{"use strict";p();Object.defineProperty(lr,"__esModule",{value:!0});lr.serialize=void 0;var wn=Fs(),H=new wn.Writer,_c=o(r=>{H.addInt16(3).addInt16(0);for(let n of Object.keys(r))H.addCString(n).addCString(r[n]);H.addCString("client_encoding").addCString("UTF8");var e=H.addCString("").flush(),t=e.length+4;return new wn.Writer().addInt32(t).add(e).flush()},"startup"),Uc=o(()=>{let r=y.allocUnsafe(8);return r.writeInt32BE(8,0),r.writeInt32BE(80877103,4),r},"requestSsl"),Cc=o(r=>H.addCString(r).flush(112),"password"),Ic=o(function(r,e){return H.addCString(r).addInt32(y.byteLength(e)).addString(e),H.flush(112)},"sendSASLInitialResponseMessage"),Lc=o(function(r){return H.addString(r).flush(112)},"sendSCRAMClientFinalMessage"),Tc=o(r=>H.addCString(r).flush(81),"query"),Ms=[],Bc=o(r=>{let e=r.name||"";e.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",e,e.length),console.error("This can cause conflicts and silent errors executing queries"));let t=r.types||Ms;for(var n=t.length,i=H.addCString(e).addCString(r.text).addInt16(n),s=0;s<n;s++)i.addInt32(t[s]);return H.flush(80)},"parse"),Xe=new wn.Writer,Pc=o(function(r,e){for(let t=0;t<r.length;t++){let n=e?e(r[t],t):r[t];n==null?(H.addInt16(0),Xe.addInt32(-1)):n instanceof y?(H.addInt16(1),Xe.addInt32(n.length),Xe.add(n)):(H.addInt16(0),Xe.addInt32(y.byteLength(n)),Xe.addString(n))}},"writeValues"),Rc=o((r={})=>{let e=r.portal||"",t=r.statement||"",n=r.binary||!1,i=r.values||Ms,s=i.length;return H.addCString(e).addCString(t),H.addInt16(s),Pc(i,r.valueMapper),H.addInt16(s),H.add(Xe.flush()),H.addInt16(n?1:0),H.flush(66)},"bind"),Fc=y.from([69,0,0,0,9,0,0,0,0,0]),Mc=o(r=>{if(!r||!r.portal&&!r.rows)return Fc;let e=r.portal||"",t=r.rows||0,n=y.byteLength(e),i=4+n+1+4,s=y.allocUnsafe(1+i);return s[0]=69,s.writeInt32BE(i,1),s.write(e,5,"utf-8"),s[n+5]=0,s.writeUInt32BE(t,s.length-4),s},"execute"),kc=o((r,e)=>{let t=y.allocUnsafe(16);return t.writeInt32BE(16,0),t.writeInt16BE(1234,4),t.writeInt16BE(5678,6),t.writeInt32BE(r,8),t.writeInt32BE(e,12),t},"cancel"),mn=o((r,e)=>{let n=4+y.byteLength(e)+1,i=y.allocUnsafe(1+n);return i[0]=r,i.writeInt32BE(n,1),i.write(e,5,"utf-8"),i[n]=0,i},"cstringMessage"),Nc=H.addCString("P").flush(68),Dc=H.addCString("S").flush(68),qc=o(r=>r.name?mn(68,`${r.type}${r.name||""}`):r.type==="P"?Nc:Dc,"describe"),Oc=o(r=>{let e=`${r.type}${r.name||""}`;return mn(67,e)},"close"),Qc=o(r=>H.add(r).flush(100),"copyData"),Hc=o(r=>mn(102,r),"copyFail"),hr=o(r=>y.from([r,0,0,0,4]),"codeOnlyBuffer"),jc=hr(72),Kc=hr(83),$c=hr(88),Wc=hr(99),Vc={startup:_c,password:Cc,requestSsl:Uc,sendSASLInitialResponseMessage:Ic,sendSCRAMClientFinalMessage:Lc,query:Tc,parse:Bc,bind:Rc,execute:Mc,describe:qc,close:Oc,flush:()=>jc,sync:()=>Kc,end:()=>$c,copyData:Qc,copyDone:()=>Wc,copyFail:Hc,cancel:kc};lr.serialize=Vc});var Ns=T(dr=>{"use strict";p();Object.defineProperty(dr,"__esModule",{value:!0});dr.BufferReader=void 0;var Gc=y.allocUnsafe(0),fr=class{constructor(e=0){this.offset=e,this.buffer=Gc,this.encoding="utf-8"}setBuffer(e,t){this.offset=e,this.buffer=t}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}string(e){let t=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,t}cstring(){let e=this.offset,t=e;for(;this.buffer[t++]!==0;);return this.offset=t,this.buffer.toString(this.encoding,e,t-1)}bytes(e){let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}};o(fr,"BufferReader");dr.BufferReader=fr});var Ds={};we(Ds,{default:()=>zc});var zc,qs=ne(()=>{p();zc={}});var Hs=T(et=>{"use strict";p();var Yc=et&&et.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(et,"__esModule",{value:!0});et.Parser=void 0;var $=yn(),Jc=Ns(),Zc=Yc((qs(),Y(Ds))),gn=1,Xc=4,Os=gn+Xc,Qs=y.allocUnsafe(0),pr=class{constructor(e){if(this.buffer=Qs,this.bufferLength=0,this.bufferOffset=0,this.reader=new Jc.BufferReader,e?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,t){this.mergeBuffer(e);let n=this.bufferOffset+this.bufferLength,i=this.bufferOffset;for(;i+Os<=n;){let s=this.buffer[i],a=this.buffer.readUInt32BE(i+gn),u=gn+a;if(u+i<=n){let c=this.handlePacket(i+Os,s,a,this.buffer);t(c),i+=u}else break}i===n?(this.buffer=Qs,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=n-i,this.bufferOffset=i)}mergeBuffer(e){if(this.bufferLength>0){let t=this.bufferLength+e.byteLength;if(t+this.bufferOffset>this.buffer.byteLength){let i;if(t<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)i=this.buffer;else{let s=this.buffer.byteLength*2;for(;t>=s;)s*=2;i=y.allocUnsafe(s)}this.buffer.copy(i,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=i,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=t}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,t,n,i){switch(t){case 50:return $.bindComplete;case 49:return $.parseComplete;case 51:return $.closeComplete;case 110:return $.noData;case 115:return $.portalSuspended;case 99:return $.copyDone;case 87:return $.replicationStart;case 73:return $.emptyQuery;case 68:return this.parseDataRowMessage(e,n,i);case 67:return this.parseCommandCompleteMessage(e,n,i);case 90:return this.parseReadyForQueryMessage(e,n,i);case 65:return this.parseNotificationMessage(e,n,i);case 82:return this.parseAuthenticationResponse(e,n,i);case 83:return this.parseParameterStatusMessage(e,n,i);case 75:return this.parseBackendKeyData(e,n,i);case 69:return this.parseErrorMessage(e,n,i,"error");case 78:return this.parseErrorMessage(e,n,i,"notice");case 84:return this.parseRowDescriptionMessage(e,n,i);case 116:return this.parseParameterDescriptionMessage(e,n,i);case 71:return this.parseCopyInMessage(e,n,i);case 72:return this.parseCopyOutMessage(e,n,i);case 100:return this.parseCopyData(e,n,i);default:Zc.default.fail(`unknown message code: ${t.toString(16)}`)}}parseReadyForQueryMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.string(1);return new $.ReadyForQueryMessage(t,i)}parseCommandCompleteMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.cstring();return new $.CommandCompleteMessage(t,i)}parseCopyData(e,t,n){let i=n.slice(e,e+(t-4));return new $.CopyDataMessage(t,i)}parseCopyInMessage(e,t,n){return this.parseCopyMessage(e,t,n,"copyInResponse")}parseCopyOutMessage(e,t,n){return this.parseCopyMessage(e,t,n,"copyOutResponse")}parseCopyMessage(e,t,n,i){this.reader.setBuffer(e,n);let s=this.reader.byte()!==0,a=this.reader.int16(),u=new $.CopyResponse(t,i,s,a);for(let c=0;c<a;c++)u.columnTypes[c]=this.reader.int16();return u}parseNotificationMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s=this.reader.cstring(),a=this.reader.cstring();return new $.NotificationResponseMessage(t,i,s,a)}parseRowDescriptionMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new $.RowDescriptionMessage(t,i);for(let a=0;a<i;a++)s.fields[a]=this.parseField();return s}parseField(){let e=this.reader.cstring(),t=this.reader.int32(),n=this.reader.int16(),i=this.reader.int32(),s=this.reader.int16(),a=this.reader.int32(),u=this.reader.int16()===0?"text":"binary";return new $.Field(e,t,n,i,s,a,u)}parseParameterDescriptionMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new $.ParameterDescriptionMessage(t,i);for(let a=0;a<i;a++)s.dataTypeIDs[a]=this.reader.int32();return s}parseDataRowMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int16(),s=new Array(i);for(let a=0;a<i;a++){let u=this.reader.int32();s[a]=u===-1?null:this.reader.string(u)}return new $.DataRowMessage(t,s)}parseParameterStatusMessage(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.cstring(),s=this.reader.cstring();return new $.ParameterStatusMessage(t,i,s)}parseBackendKeyData(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s=this.reader.int32();return new $.BackendKeyDataMessage(t,i,s)}parseAuthenticationResponse(e,t,n){this.reader.setBuffer(e,n);let i=this.reader.int32(),s={name:"authenticationOk",length:t};switch(i){case 0:break;case 3:s.length===8&&(s.name="authenticationCleartextPassword");break;case 5:if(s.length===12){s.name="authenticationMD5Password";let u=this.reader.bytes(4);return new $.AuthenticationMD5Password(t,u)}break;case 10:s.name="authenticationSASL",s.mechanisms=[];let a;do a=this.reader.cstring(),a&&s.mechanisms.push(a);while(a);break;case 11:s.name="authenticationSASLContinue",s.data=this.reader.string(t-8);break;case 12:s.name="authenticationSASLFinal",s.data=this.reader.string(t-8);break;default:throw new Error("Unknown authenticationOk message type "+i)}return s}parseErrorMessage(e,t,n,i){this.reader.setBuffer(e,n);let s={},a=this.reader.string(1);for(;a!=="\0";)s[a]=this.reader.cstring(),a=this.reader.string(1);let u=s.M,c=i==="notice"?new $.NoticeMessage(t,u):new $.DatabaseError(u,t,i);return c.severity=s.S,c.code=s.C,c.detail=s.D,c.hint=s.H,c.position=s.P,c.internalPosition=s.p,c.internalQuery=s.q,c.where=s.W,c.schema=s.s,c.table=s.t,c.column=s.c,c.dataType=s.d,c.constraint=s.n,c.file=s.F,c.line=s.L,c.routine=s.R,c}};o(pr,"Parser");et.Parser=pr});var Sn=T(Pe=>{"use strict";p();Object.defineProperty(Pe,"__esModule",{value:!0});Pe.DatabaseError=Pe.serialize=Pe.parse=void 0;var eh=yn();Object.defineProperty(Pe,"DatabaseError",{enumerable:!0,get:function(){return eh.DatabaseError}});var th=ks();Object.defineProperty(Pe,"serialize",{enumerable:!0,get:function(){return th.serialize}});var rh=Hs();function nh(r,e){let t=new rh.Parser;return r.on("data",n=>t.parse(n,e)),new Promise(n=>r.on("end",()=>n()))}o(nh,"parse");Pe.parse=nh});var js={};we(js,{connect:()=>ih});function ih(r){let{socket:e,servername:t}=r;return e.startTls(t),e}var Ks=ne(()=>{p();o(ih,"connect")});var bn=T((yd,Vs)=>{"use strict";p();var $s=(pn(),Y(Rs)),sh=Le().EventEmitter,{parse:ah,serialize:ee}=Sn(),Ws=ee.flush(),oh=ee.sync(),uh=ee.end(),yr=class extends sh{constructor(e){super(),e=e||{},this.stream=e.stream||new $s.Socket,this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;var t=this;this.on("newListener",function(n){n==="message"&&(t._emitMessage=!0)})}connect(e,t){var n=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,t),this.stream.once("connect",function(){n._keepAlive&&n.stream.setKeepAlive(!0,n._keepAliveInitialDelayMillis),n.emit("connect")});let i=o(function(s){n._ending&&(s.code==="ECONNRESET"||s.code==="EPIPE")||n.emit("error",s)},"reportStreamError");if(this.stream.on("error",i),this.stream.on("close",function(){n.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(s){var a=s.toString("utf8");switch(a){case"S":break;case"N":return n.stream.end(),n.emit("error",new Error("The server does not support SSL connections"));default:return n.stream.end(),n.emit("error",new Error("There was an error establishing an SSL connection"))}var u=(Ks(),Y(js));let c={socket:n.stream};n.ssl!==!0&&(Object.assign(c,n.ssl),"key"in n.ssl&&(c.key=n.ssl.key)),$s.isIP(t)===0&&(c.servername=t);try{n.stream=u.connect(c)}catch(h){return n.emit("error",h)}n.attachListeners(n.stream),n.stream.on("error",i),n.emit("sslconnect")})}attachListeners(e){e.on("end",()=>{this.emit("end")}),ah(e,t=>{var n=t.name==="error"?"errorMessage":t.name;this._emitMessage&&this.emit("message",t),this.emit(n,t)})}requestSsl(){this.stream.write(ee.requestSsl())}startup(e){this.stream.write(ee.startup(e))}cancel(e,t){this._send(ee.cancel(e,t))}password(e){this._send(ee.password(e))}sendSASLInitialResponseMessage(e,t){this._send(ee.sendSASLInitialResponseMessage(e,t))}sendSCRAMClientFinalMessage(e){this._send(ee.sendSCRAMClientFinalMessage(e))}_send(e){return this.stream.writable?this.stream.write(e):!1}query(e){this._send(ee.query(e))}parse(e){this._send(ee.parse(e))}bind(e){this._send(ee.bind(e))}execute(e){this._send(ee.execute(e))}flush(){this.stream.writable&&this.stream.write(Ws)}sync(){this._ending=!0,this._send(Ws),this._send(oh)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(uh,()=>{this.stream.end()})}close(e){this._send(ee.close(e))}describe(e){this._send(ee.describe(e))}sendCopyFromChunk(e){this._send(ee.copyData(e))}endCopyFrom(){this._send(ee.copyDone())}sendCopyFail(e){this._send(ee.copyFail(e))}};o(yr,"Connection");Vs.exports=yr});var Ys=T((Sd,zs)=>{"use strict";p();var ch=Le().EventEmitter,gd=(yt(),Y(pt)),hh=dt(),xn=Wi(),lh=ns(),fh=rn(),dh=Qt(),Gs=gs(),ph=ft(),yh=bn(),bt=class extends ch{constructor(e){super(),this.connectionParameters=new dh(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var t=e||{};this._Promise=t.Promise||v.Promise,this._types=new fh(t.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=t.connection||new yh({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||ph.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=o(n=>{w.nextTick(()=>{n.handleError(e,this.connection)})},"enqueueError");this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){var t=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let i=new Error("Client has already been connected. You cannot reuse a client.");w.nextTick(()=>{e(i)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){t.ssl?n.requestSsl():n.startup(t.getStartupConf())}),n.on("sslconnect",function(){n.startup(t.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let i=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(i),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(i):this._handleErrorEvent(i):this._connectionError||this._handleErrorEvent(i)),w.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((t,n)=>{this._connect(i=>{i?n(i):t()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){t.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{t.emit("error",n)}):this.password!==null?e():lh(this.connectionParameters,n=>{n!==void 0&&(this.connectionParameters.password=this.password=n),e()})}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(()=>{let t=hh.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)})}_handleAuthSASL(e){this._checkPgPass(()=>{this.saslSession=xn.startSession(e.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(e){xn.continueSession(this.saslSession,this.password,e.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(e){xn.finalizeSession(this.saslSession,e.data),this.saslSession=null}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;if(!t){this._handleErrorEvent(e);return}this.activeQuery=null,t.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(e){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){var e=this.connectionParameters,t={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(t.application_name=n),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){var n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(t)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,n){return this._types.setTypeParser(e,t,n)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return'"'+e.replace(/"/g,'""')+'"'}escapeLiteral(e){for(var t=!1,n="'",i=0;i<e.length;i++){var s=e[i];s==="'"?n+=s+s:s==="\\"?(n+=s+s,t=!0):n+=s}return n+="'",t===!0&&(n=" E"+n),n}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&w.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,n){var i,s,a,u,c;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(a=e.query_timeout||this.connectionParameters.query_timeout,s=i=e,typeof t=="function"&&(i.callback=i.callback||t)):(a=this.connectionParameters.query_timeout,i=new Gs(e,t,n),i.callback||(s=new this._Promise((h,l)=>{i.callback=(f,m)=>f?l(f):h(m)}))),a&&(c=i.callback,u=setTimeout(()=>{var h=new Error("Query read timeout");w.nextTick(()=>{i.handleError(h,this.connection)}),c(h),i.callback=()=>{};var l=this.queryQueue.indexOf(i);l>-1&&this.queryQueue.splice(l,1),this._pulseQueryQueue()},a),i.callback=(h,l)=>{clearTimeout(u),c(h,l)}),this.binary&&!i.binary&&(i.binary=!0),i._result&&!i._result._types&&(i._result._types=this._types),this._queryable?this._ending?(w.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"),this.connection)}),s):(this.queryQueue.push(i),this._pulseQueryQueue(),s):(w.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),s)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(t=>{this.connection.once("end",t)})}};o(bt,"Client");bt.Query=Gs;zs.exports=bt});var ea=T((Ad,Xs)=>{"use strict";p();var wh=Le().EventEmitter,Js=o(function(){},"NOOP"),Zs=o((r,e)=>{let t=r.findIndex(e);return t===-1?void 0:r.splice(t,1)[0]},"removeWhere"),mr=class{constructor(e,t,n){this.client=e,this.idleListener=t,this.timeoutId=n}};o(mr,"IdleItem");var ke=class{constructor(e){this.callback=e}};o(ke,"PendingItem");function mh(){throw new Error("Release called on client which has already been released to the pool.")}o(mh,"throwOnDoubleRelease");function wr(r,e){if(e)return{callback:e,result:void 0};let t,n,i=o(function(a,u){a?t(a):n(u)},"cb"),s=new r(function(a,u){n=a,t=u});return{callback:i,result:s}}o(wr,"promisify");function gh(r,e){return o(function t(n){n.client=e,e.removeListener("error",t),e.on("error",()=>{r.log("additional client error after disconnection due to error",n)}),r._remove(e),r.emit("error",n,e)},"idleListener")}o(gh,"makeIdleListener");var gr=class extends wh{constructor(e,t){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||Sr().Client,this.Promise=this.options.Promise||v.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(t=>{this._remove(t.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let n=t.client;n.ref&&n.ref();let i=t.idleListener;return this._acquireClient(n,e,i,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e){let t=Zs(this._idle,n=>n.client===e);t!==void 0&&clearTimeout(t.timeoutId),this._clients=this._clients.filter(n=>n!==e),e.end(),this.emit("remove",e)}connect(e){if(this.ending){let i=new Error("Cannot use a pool after calling end on the pool");return e?e(i):this.Promise.reject(i)}let t=wr(this.Promise,e),n=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&w.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new ke(t.callback)),n;let i=o((u,c,h)=>{clearTimeout(a),t.callback(u,c,h)},"queueCallback"),s=new ke(i),a=setTimeout(()=>{Zs(this._pendingQueue,u=>u.callback===i),s.timedOut=!0,t.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(s),n}return this.newClient(new ke(t.callback)),n}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let n=gh(this,t);this.log("checking client timeout");let i,s=!1;this.options.connectionTimeoutMillis&&(i=setTimeout(()=>{this.log("ending client due to timeout"),s=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(a=>{if(i&&clearTimeout(i),t.on("error",n),a)this.log("client failed to connect",a),this._clients=this._clients.filter(u=>u!==t),s&&(a.message="Connection terminated due to connection timeout"),this._pulseQueue(),e.timedOut||e.callback(a,void 0,Js);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let u=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),this._idle.findIndex(h=>h.client===t)!==-1&&this._acquireClient(t,new ke((h,l,f)=>f()),n,!1)},this.options.maxLifetimeSeconds*1e3);u.unref(),t.once("end",()=>clearTimeout(u))}return this._acquireClient(t,e,n,!0)}})}_acquireClient(e,t,n,i){i&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),t.timedOut?i&&this.options.verify?this.options.verify(e,e.release):e.release():i&&this.options.verify?this.options.verify(e,s=>{if(s)return e.release(s),t.callback(s,void 0,Js);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let n=!1;return i=>{n&&mh(),n=!0,this._release(e,t,i)}}_release(e,t,n){if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses){e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e),this._pulseQueue();return}if(this._expired.has(e)){this.log("remove expired client"),this._expired.delete(e),this._remove(e),this._pulseQueue();return}let s;this.options.idleTimeoutMillis&&(s=setTimeout(()=>{this.log("remove idle client"),this._remove(e)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&s.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new mr(e,t,s)),this._pulseQueue()}query(e,t,n){if(typeof e=="function"){let s=wr(this.Promise,e);return E(function(){return s.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),s.result}typeof t=="function"&&(n=t,t=void 0);let i=wr(this.Promise,n);return n=i.callback,this.connect((s,a)=>{if(s)return n(s);let u=!1,c=o(h=>{u||(u=!0,a.release(h),n(h))},"onError");a.once("error",c),this.log("dispatching query");try{a.query(e,t,(h,l)=>{if(this.log("query dispatched"),a.removeListener("error",c),!u)return u=!0,a.release(h),h?n(h):n(void 0,l)})}catch(h){return a.release(h),n(h)}}),i.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let t=wr(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+(this._expired.has(t)?1:0),0)}get totalCount(){return this._clients.length}};o(gr,"Pool");Xs.exports=gr});var ta={};we(ta,{default:()=>Sh});var Sh,ra=ne(()=>{p();Sh={}});var na=T((Ud,bh)=>{bh.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}});var aa=T((Cd,sa)=>{"use strict";p();var ia=Le().EventEmitter,xh=(yt(),Y(pt)),An=dt(),tt=sa.exports=function(r,e,t){ia.call(this),r=An.normalizeQueryConfig(r,e,t),this.text=r.text,this.values=r.values,this.name=r.name,this.callback=r.callback,this.state="new",this._arrayMode=r.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};xh.inherits(tt,ia);var Ah={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tt.prototype.handleError=function(r){var e=this.native.pq.resultErrorFields();if(e)for(var t in e){var n=Ah[t]||t;r[n]=e[t]}this.callback?this.callback(r):this.emit("error",r),this.state="error"};tt.prototype.then=function(r,e){return this._getPromise().then(r,e)};tt.prototype.catch=function(r){return this._getPromise().catch(r)};tt.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(r,e){this._once("end",r),this._once("error",e)}.bind(this)),this._promise)};tt.prototype.submit=function(r){this.state="running";var e=this;this.native=r.native,r.native.arrayMode=this._arrayMode;var t=o(function(s,a,u){if(r.native.arrayMode=!1,E(function(){e.emit("_done")}),s)return e.handleError(s);e._emitRowEvents&&(u.length>1?a.forEach((c,h)=>{c.forEach(l=>{e.emit("row",l,u[h])})}):a.forEach(function(c){e.emit("row",c,u)})),e.state="end",e.emit("end",u),e.callback&&e.callback(null,u)},"after");if(w.domain&&(t=w.domain.bind(t)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var n=(this.values||[]).map(An.prepareValue);if(r.namedQueries[this.name]){if(this.text&&r.namedQueries[this.name]!==this.text){let s=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return t(s)}return r.native.execute(this.name,n,t)}return r.native.prepare(this.name,this.text,n.length,function(s){return s?t(s):(r.namedQueries[e.name]=e.text,e.native.execute(e.name,n,t))})}else if(this.values){if(!Array.isArray(this.values)){let s=new Error("Query values must be an array");return t(s)}var i=this.values.map(An.prepareValue);r.native.query(this.text,i,t)}else r.native.query(this.text,t)}});var ha=T((Bd,ca)=>{"use strict";p();var vh=(ra(),Y(ta)),Eh=rn(),Td=na(),oa=Le().EventEmitter,_h=(yt(),Y(pt)),Uh=Qt(),ua=aa(),pe=ca.exports=function(r){oa.call(this),r=r||{},this._Promise=r.Promise||v.Promise,this._types=new Eh(r.types),this.native=new vh({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var e=this.connectionParameters=new Uh(r);this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};pe.Query=ua;_h.inherits(pe,oa);pe.prototype._errorAllQueries=function(r){let e=o(t=>{w.nextTick(()=>{t.native=this.native,t.handleError(r)})},"enqueueError");this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};pe.prototype._connect=function(r){var e=this;if(this._connecting){w.nextTick(()=>r(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(t,n){if(t)return r(t);e.native.connect(n,function(i){if(i)return e.native.end(),r(i);e._connected=!0,e.native.on("error",function(s){e._queryable=!1,e._errorAllQueries(s),e.emit("error",s)}),e.native.on("notification",function(s){e.emit("notification",{channel:s.relname,payload:s.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),r()})})};pe.prototype.connect=function(r){if(r){this._connect(r);return}return new this._Promise((e,t)=>{this._connect(n=>{n?t(n):e()})})};pe.prototype.query=function(r,e,t){var n,i,s,a,u;if(r==null)throw new TypeError("Client was passed a null or undefined query");if(typeof r.submit=="function")s=r.query_timeout||this.connectionParameters.query_timeout,i=n=r,typeof e=="function"&&(r.callback=e);else if(s=this.connectionParameters.query_timeout,n=new ua(r,e,t),!n.callback){let c,h;i=new this._Promise((l,f)=>{c=l,h=f}),n.callback=(l,f)=>l?h(l):c(f)}return s&&(u=n.callback,a=setTimeout(()=>{var c=new Error("Query read timeout");w.nextTick(()=>{n.handleError(c,this.connection)}),u(c),n.callback=()=>{};var h=this._queryQueue.indexOf(n);h>-1&&this._queryQueue.splice(h,1),this._pulseQueryQueue()},s),n.callback=(c,h)=>{clearTimeout(a),u(c,h)}),this._queryable?this._ending?(n.native=this.native,w.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),i):(this._queryQueue.push(n),this._pulseQueryQueue(),i):(n.native=this.native,w.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),i)};pe.prototype.end=function(r){var e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,r));var t;return r||(t=new this._Promise(function(n,i){r=o(s=>s?i(s):n(),"cb")})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),w.nextTick(()=>{e.emit("end"),r&&r()})}),t};pe.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};pe.prototype._pulseQueryQueue=function(r){if(!!this._connected&&!this._hasActiveQuery()){var e=this._queryQueue.shift();if(!e){r||this.emit("drain");return}this._activeQuery=e,e.submit(this);var t=this;e.once("_done",function(){t._pulseQueryQueue()})}};pe.prototype.cancel=function(r){this._activeQuery===r?this.native.cancel(function(){}):this._queryQueue.indexOf(r)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(r),1)};pe.prototype.ref=function(){};pe.prototype.unref=function(){};pe.prototype.setTypeParser=function(r,e,t){return this._types.setTypeParser(r,e,t)};pe.prototype.getTypeParser=function(r,e){return this._types.getTypeParser(r,e)}});var vn=T((Fd,la)=>{"use strict";p();la.exports=ha()});var Sr=T((Nd,xt)=>{"use strict";p();var Ch=Ys(),Ih=ft(),Lh=bn(),Th=ea(),{DatabaseError:Bh}=Sn(),Ph=o(r=>o(class extends Th{constructor(t){super(t,r)}},"BoundPool"),"poolFactory"),En=o(function(r){this.defaults=Ih,this.Client=r,this.Query=this.Client.Query,this.Pool=Ph(this.Client),this._pools=[],this.Connection=Lh,this.types=lt(),this.DatabaseError=Bh},"PG");typeof w.env.NODE_PG_FORCE_NATIVE<"u"?xt.exports=new En(vn()):(xt.exports=new En(Ch),Object.defineProperty(xt.exports,"native",{configurable:!0,enumerable:!1,get(){var r=null;try{r=new En(vn())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(xt.exports,"native",{value:r}),r}}))});var Fh={};we(Fh,{Client:()=>At,ClientBase:()=>de.ClientBase,Connection:()=>de.Connection,DatabaseError:()=>de.DatabaseError,Pool:()=>br,Query:()=>de.Query,defaults:()=>de.defaults,neon:()=>Pt,neonConfig:()=>X,types:()=>de.types});module.exports=Y(Fh);p();p();p();function Jn(r,e=!1){let{protocol:t}=new URL(r),n="http:"+r.substring(t.length),{username:i,password:s,host:a,hostname:u,port:c,pathname:h,search:l,searchParams:f,hash:m}=new URL(n);s=decodeURIComponent(s);let b=i+":"+s,_=e?Object.fromEntries(f.entries()):l;return{href:r,protocol:t,auth:b,username:i,password:s,host:a,hostname:u,port:c,pathname:h,search:l,query:_,hash:m}}o(Jn,"parse");var Bi=nt(dt());var We=class extends Error{constructor(){super(...arguments);g(this,"code",null);g(this,"name","NeonDbError")}};o(We,"NeonDbError");function Pt(r,{arrayMode:e,fullResults:t,queryCallback:n,resultCallback:i}={}){let s=Jn(r),{protocol:a,username:u,password:c,hostname:h,pathname:l}=s;if(a!=="postgres:"&&a!=="postgresql:"||!h||!u||!c||!l)throw new Error("Database connection string format should be: postgres://user:password@host.tld/dbname?option=value");return async function(f,...m){let b;if(typeof f=="string")b=f,m=m[0]??[];else{b="";for(let A=0;A<f.length;A++)b+=f[A],A<m.length&&(b+="$"+(A+1))}m=m.map(A=>(0,Bi.prepareValue)(A));let _,L;try{let A=`https://${h}/sql`;_={query:b,params:m},n&&n(_),L=await fetch(A,{body:JSON.stringify(_),method:"POST",headers:{"Neon-Connection-String":r,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"}})}catch(A){throw new We(`Error connecting to database: ${A.message}`)}if(L.ok){let A=await L.json(),P=A.fields.map(D=>D.name),I=A.fields.map(D=>de.types.getTypeParser(D.dataTypeID)),x=e===!0?A.rows.map(D=>D.map((W,k)=>W===null?null:I[k](W))):A.rows.map(D=>Object.fromEntries(D.map((W,k)=>[P[k],W===null?null:I[k](W)])));return i&&i(_,A,x),t?(A.viaNeonFetch=!0,A.rowAsArray=e,A.rows=x,A):x}else{let{status:A}=L;if(A===400){let{message:P,code:I}=await L.json(),x=new We(P);throw x.code=I,x}else{let P=await L.text();throw new We(`Database error (HTTP status ${A}): ${P}`)}}}}o(Pt,"neon");var xr=nt(Sr());pn();var fa=nt(Qt()),de=nt(Sr());var At=class extends xr.Client{get neonConfig(){return this.connection.stream}connect(e){let{neonConfig:t}=this;t.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&t.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true."),this.host==="localhost"&&console.warn("The database host is 'localhost', which is the default host when none is set. If that's intentional, please ignore this warning. If not, perhaps an environment variable has not been set, or has not been passed to the library?");let n=super.connect(e),i=t.pipelineTLS&&this.ssl,s=t.pipelineConnect==="password";if(!i&&!t.pipelineConnect)return n;let a=this.connection;if(i&&a.on("connect",()=>a.stream.emit("data","S")),s){a.removeAllListeners("authenticationCleartextPassword"),a.removeAllListeners("readyForQuery"),a.once("readyForQuery",()=>a.on("readyForQuery",this._handleReadyForQuery.bind(this)));let u=this.ssl?"sslconnect":"connect";a.on(u,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return n}async _handleAuthSASLContinue(e){let t=this.saslSession,n=this.password,i=e.data;if(t.message!=="SASLInitialResponse"||typeof n!="string"||typeof i!="string")throw new Error("SASL: protocol error");let s=Object.fromEntries(i.split(",").map(ue=>{if(!/^.=/.test(ue))throw new Error("SASL: Invalid attribute pair entry");let re=ue[0],z=ue.substring(2);return[re,z]})),a=s.r,u=s.s,c=s.i;if(!a||!/^[!-+--~]+$/.test(a))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!u||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(u))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!c||!/^[1-9][0-9]*$/.test(c))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!a.startsWith(t.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(a.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let h=parseInt(c,10),l=y.from(u,"base64"),f=new TextEncoder,m=f.encode(n),b=await S.subtle.importKey("raw",m,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),_=new Uint8Array(await S.subtle.sign("HMAC",b,y.concat([l,y.from([0,0,0,1])]))),L=_;for(var A=0;A<h-1;A++)_=new Uint8Array(await S.subtle.sign("HMAC",b,_)),L=y.from(L.map((ue,re)=>L[re]^_[re]));let P=L,I=await S.subtle.importKey("raw",P,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),x=new Uint8Array(await S.subtle.sign("HMAC",I,f.encode("Client Key"))),D=await S.subtle.digest("SHA-256",x),W="n=*,r="+t.clientNonce,k="r="+a+",s="+u+",i="+h,J="c=biws,r="+a,N=W+","+k+","+J,ye=await S.subtle.importKey("raw",D,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var B=new Uint8Array(await S.subtle.sign("HMAC",ye,f.encode(N))),F=y.from(x.map((ue,re)=>x[re]^B[re])),q=F.toString("base64");let j=await S.subtle.importKey("raw",P,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),V=await S.subtle.sign("HMAC",j,f.encode("Server Key")),G=await S.subtle.importKey("raw",V,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var O=y.from(await S.subtle.sign("HMAC",G,f.encode(N)));t.message="SASLResponse",t.serverSignature=O.toString("base64"),t.response=J+",p="+q,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};o(At,"NeonClient");function Rh(r,e){if(e)return{callback:e,result:void 0};let t,n,i=o(function(a,u){a?t(a):n(u)},"cb"),s=new r(function(a,u){n=a,t=u});return{callback:i,result:s}}o(Rh,"promisify");var br=class extends xr.Pool{constructor(){super(...arguments);g(this,"Client",At);g(this,"hasFetchUnsupportedListeners",!1)}on(t,n){return t!=="error"&&(this.hasFetchUnsupportedListeners=!0),super.on(t,n)}query(t,n,i){if(!X.poolQueryViaFetch||this.hasFetchUnsupportedListeners||typeof t=="function")return super.query(t,n,i);typeof n=="function"&&(i=n,n=void 0);let s=Rh(this.Promise,i);i=s.callback;try{let a=new fa.default(this.options),u=encodeURIComponent,c=encodeURI,h=`postgresql://${u(a.user)}:${u(a.password)}@${u(a.host)}/${c(a.database)}`,l=typeof t=="string"?t:t.text,f=(typeof t=="string"?n:t.values)??[];Pt(h,{fullResults:!0,arrayMode:t.rowMode==="array"})(l,f).then(b=>i(void 0,b)).catch(b=>i(b))}catch(a){i(a)}return s.result}};o(br,"NeonPool");
